/*
Copyright (c) Copyright (c) 2007, Carl S. Yestrau All rights reserved.
Code licensed under the BSD License: http://www.featureblend.com/license.txt
Version: 1.0.4
*/

define("path",[],function(){var e=function(e){return a.defined.hasOwnProperty(e)?a.defined[e]:new u.route(e)},t=function(e){a.root=e},n=function(e){a.rescue=e},r={initial:{},pushState:function(e,t,n){r.supported?s(n)&&history.pushState(e,t,n):r.fallback&&(window.location.hash="#"+n)},popState:function(e){var t=!r.initial.popped&&location.href==r.initial.URL;r.initial.popped=!0;if(t)return;s(document.location.pathname)},listen:function(e){r.supported=!!window.history&&!!window.history.pushState,r.fallback=e;if(r.supported)r.initial.popped="state"in window.history,r.initial.URL=location.href,window.onpopstate=r.popState;else if(r.fallback){for(route in a.defined)route.charAt(0)!="#"&&(a.defined["#"+route]=a.defined[route],a.defined["#"+route].path="#"+route);o()}}},i=function(e,t){var n={},r=null,i,s,o,u,f,l,c,h;for(r in a.defined)if(r!==null&&r!==undefined){r=a.defined[r];if(r.path===e)return r;i=r.partition();for(u=0;u<i.length;u++){s=i[u],f=e;if(s.search(/:/)>0){c=f.split("/"),l=s.split("/");for(o=0;o<l.length;o++)o<c.length&&l[o].charAt(0)===":"&&(l[o].charAt(l[o].length-1)==="*"?(h=f.split("/").slice(o).join("/"),f=f.replace(h,s.split("/").slice(o).join("/"))):(h=f.split("/")[o],f=f.replace(f.split("/")[o],s.split("/")[o])),n[s.split("/")[o].replace(/[:*]/g,"")]=h)}if(s===f)return t&&(r.params=n),r}}return null},s=function(e){var t,n;if(a.current!==e){a.previous=a.current,a.current=e,n=i(e,!0),a.previous&&(t=i(a.previous),t!==null&&t.do_exit!==null&&t.do_exit());if(n!==null)return n.run(),!0;a.rescue!==null&&a.rescue()}return!1},o=function(){var e=function(){s(location.hash)};location.hash===""&&a.root!==null&&(location.hash=a.root),"onhashchange"in window&&(!document.documentMode||document.documentMode>=8)?window.onhashchange=e:setInterval(e,50),location.hash!==""&&s(location.hash)},u={route:function(e){this.path=e,this.action=null,this.do_enter=[],this.do_exit=null,this.params={},a.defined[e]=this}},a={current:null,root:null,rescue:null,previous:null,defined:{}};return u.route.prototype={to:function(e){return this.action=e,this},enter:function(e){return e instanceof Array?this.do_enter=this.do_enter.concat(e):this.do_enter.push(e),this},exit:function(e){return this.do_exit=e,this},partition:function(){var e=[],t=[],n=/\(([^}]+?)\)/g,r,i;r=n.exec(this.path);while(r)e.push(r[1]),r=n.exec(this.path);t.push(this.path.split("(")[0]);for(i=0;i<e.length;i++)t.push(t[t.length-1]+e[i]);return t},run:function(){var e=!1,t,n,r;if(a.defined[this.path].hasOwnProperty("do_enter")&&a.defined[this.path].do_enter.length>0)for(t=0;t<a.defined[this.path].do_enter.length;t++){n=a.defined[this.path].do_enter[t].apply(this,[]);if(n===!1){e=!0;break}}e||a.defined[this.path].action()}},{map:e,rescue:n,root:t,history:r,match:i,dispatch:s,listen:o,core:u,routes:a}}),define("util",[],function(){var e=function(e){return e?e.split("/").pop().replace(/\?[^.]*/,""):""},t=function(){var e=arguments,t=[];for(var n=0;n<e.length;n++){var r=e[n].split("/");for(var i=0;i<r.length;i++)r[i]!==""&&t.push(r[i])}return beginSlash=e[0].charAt(0)=="/"?"/":"",lastArg=e[e.length-1],endSlash=lastArg.charAt(lastArg.length-1)=="/"?"/":"",outpath=beginSlash+t.join("/")+endSlash,outpath},n=function(e){return e.replace(/^\s+|\s+$/g,"")},r=function(e){var t=function(){};return t.prototype=e,new t},i=function(e){return function(){if(window.console&&typeof window.console[e]=="function")try{window.console[e].apply(window.console,arguments)}catch(t){}}},s={};s.log=i("log"),s.error=i("error");var o=function(){return navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i)?!0:!1},u=function(){return navigator.userAgent.match(/Android/i)?!0:!1},a=function(){return o()||u()},f=function(e,t){try{var n=e!==undefined?parseInt(e,10):t;return window.isNaN(n)?t:n}catch(r){return t}};return{parseFilename:e,joinPath:t,trim:n,clone:r,console:s,isAndroid:u,isIOS:o,isMobile:a,toNumber:f}}),define("view",["jquery"],function(e){var t={view:"#mainpane",paneLinks:".pane-link",outer:"#content"},n=function(n,r){var o=e("<div></div>").addClass("spinner").html(n);return o.addClass("overlay"),r===undefined||e(t.view).find(r).length===0?(o.addClass("fullscreenMessage"),s(o)):i(r,o),o},r=function(){a&&typeof a.unload=="function"&&a.unload(),e(t.view).empty().append(e.makeArray(arguments))},i=function(n,r){e(t.view).find(n).html(r)},s=function(){e(t.view).append(e.makeArray(arguments))},o=function(){return e(t.view)},u=function(){o().empty()},a,f=function(e){a=e},l=function(n){return e(t.paneLinks+'[data-client="'+n+'"]')},c=function(n){e(t.paneLinks).each(function(){var t=e(this);t.toggleClass("active",t.data("client")===n)})},h=function(){e(t.paneLinks+".active").data("client")||undefined},p=function(){e(t.paneLinks).addClass("disabled").on("click.disable","a",function(e){return e.preventDefault(),!1})},d=function(){e(t.paneLinks).removeClass("disabled").off("click.disable","a")},v=function(){return n("Uploading")},m=function(){return e(t.outer)};return{clear:u,setContents:r,overlayContents:n,get:o,append:s,setActiveClient:c,getClientLink:l,setView:f,addUploadingBanner:v,outermost:m,disableClients:p,enableClients:d}}),define("navigation",["./path","./util","./view","jquery","lodash"],function(e,t,n,r,i){var s=function(){var e=this.current;t.console.log("not found",this.current,this),this.current!=this.root&&(location.hash=this.root)},o=function(){e.root("#/home/"),e.rescue(s),e.listen(),"standalone"in window.navigator&&window.navigator.standalone&&d()},u=function(t,n){e.map(t).enter(a).to(n)},a=function(){i.invoke(f,"call")},f=[],l=function(e){f.push(e)};l(function(){r(".nav-collapse.in").addClass("collapse").removeClass("in").css("height","0px")});var c=function(){var t=e.routes.current;try{return decodeURIComponent(t)}catch(n){try{return unescape(t)}catch(n){return t}}},h=function(){var t=c(),n=e.match(t,!0);n&&n.run()},p=function(t,n){var r=e.match(t,!0),s=r?i.clone(r.params):undefined,o=e.match(n,!0),u=o?i.clone(o.params):undefined;return!r&&!o?!0:r&&o&&r.action==o.action&&i.isEqual(s,u)},d=function(){n.outermost().delegate("a","click",function(e){if(!r(this).attr("target")||r(this).attr("target")=="_self"){var t=r(this).attr("href")||"";t&&!t.match(/^http(s?)/g)&&(e.preventDefault(),self.location=t)}})};return{finalize:o,register:u,current:c,refresh:h,matches:p,addChangeListener:l}}),define("servervars",["./util"],function(e){return server_vars.maxSize=e.toNumber(server_vars.maxSize,0),server_vars}),define("templates",["jquery","./servervars","./util"],function(e,t,n){var r=function(e,t){Handlebars.templates[e]=t},i=function(e){return Handlebars.templates?Handlebars.templates[e]:undefined},s=function(e){Handlebars.templates[e]=undefined},o=function(e,t){var n=i(e);return t=t||{},n?n(t):undefined};return{set:r,load:i,render:o,remove:s}}),define("welcome",["./navigation","./templates","./view","./servervars"],function(e,t,n,r){var i=function(){n.setContents(t.render("welcome",{header:r.welcome_header,subheader:r.welcome_subheader}))},s=function(){e.register("#/",i),e.register("#/home/",i)};return{initialize:s}}),define("prettyprint",["lodash"],function(e){var t=function(e){var t=e;return t>1073741824?(Math.round(t*100/1073741824)/100).toString()+" Gb":t>1048576?(Math.round(t*100/1048576)/100).toString()+" Mb":t>1024?(Math.round(t*100/1024)/100).toString()+" Kb":t<=1024?t.toString()+" Bytes":"Unknown"},n={"*/*":"Any File","application/atom+xml":"Atom Subscription Feed","application/json":"Javscript Object Notation (JSON)","application/javascript":"Javscript File","application/ogg":"Ogg Media File","application/pdf":"PDF File","application/postscript":"Postscript File","application/rss+xml":"RSS Feed","application/zip":"ZIP Archive","application/x-gzip":"Gzip Archive","audio/*":"Audio File","audio/mp4":"MP4 Audio File","audio/mpeg":"MP3 Audio File","image/*":"Image","image/gif":"GIF Image","image/jpeg":"JPEG Image","image/pjpeg":"JPEG Image","image/png":"PNG Image","image/svg+xml":"SVG Vector Image","image/tiff":"TIFF Image","image/vnd.microsoft.icon":"ICO image","text/*":"Text File","text/css":"Cascading Style Sheet (CSS)","text/csv":"Command Seperated Values (CSV)","text/html":"HTML Webpage","text/javascript":"Javascript File","text/plain":"Plain Text File","text/vcard":"vCard Contact File","text/xml":"XML (Extensible Markup Language)","video/*":"Video","video/mpeg":"MPEG Video","video/mp4":"MP4 Video","video/ogg":"OGG Video","video/quicktime":"Quicktime Video","video/x-flv":"Flash Video"},r=function(e){return e=e||"*/*",n[e]||e},i=function(t,n){return n=n||" or ",e.chain(t).filter().map(function(e){return r(e)}).value().join(" or ")};return{print_size:t,print_mimetype:r,print_mimetypes:i}}),define("global",[],function(){var e=function(e,t){window[e]=t};return{add:e}}),define("window",["./servervars","./global"],function(e,t){var n=function(){try{if(window.opener&&window.opener.window.is_filepicker_dialog){var e=window.location.hash?window.location.hash.substr(1):"";window.opener.window.nav.finishAuth(e),window.close()}}catch(n){}t.add("is_filepicker_dialog",!0)},r=[],i=function(e){r.push(e)},s=function(){for(var e=0;e<r.length;e++)r[e]&&typeof r[e]=="function"&&r[e]()};window.onunload=s;var o=function(){s(),e.iframe?u():self.close()},u=function(){$(".fullscreenMessage").remove(),$(".btn-upload").removeClass("disabled").text("Upload")};return{initialize:n,close:o,destroy:s,reset:u,addOnDestroy:i}}),define("notify",["jquery","view"],function(e,t){var n={selector:"#notify"},r,i=function(t,i,s){s=!!s,i=i||5e3;var o=e(n.selector).text(t).css("display","inline-block");o.toggleClass("error",s),r&&window.clearTimeout(r),r=window.setTimeout(function(){o.fadeOut()},i)},s=function(e,t){i(e,t,!0)};return{alert:i,error:s}}),define("json",[],function(){function f(e){return e<10?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];a&&typeof a=="object"&&typeof a.toJSON=="function"&&(a=a.toJSON(e)),typeof rep=="function"&&(a=rep.call(t,e,a));switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";gap+=indent,u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1)u[n]=str(n,a)||"null";return i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]",gap=o,i}if(rep&&typeof rep=="object"){s=rep.length;for(n=0;n<s;n+=1)typeof rep[n]=="string"&&(r=rep[n],i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i))}else for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i));return i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}",gap=o,i}}typeof JSON!="object"&&(JSON={}),typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;return typeof JSON.stringify!="function"&&(JSON.stringify=function(e,t,n){var r;gap="",indent="";if(typeof n=="number")for(r=0;r<n;r+=1)indent+=" ";else typeof n=="string"&&(indent=n);rep=t;if(!t||typeof t=="function"||typeof t=="object"&&typeof t.length=="number")return str("",{"":e});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=="object")for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),r!==undefined?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")}),{parse:JSON.parse,stringify:JSON.stringify}}),define("comm",["./servervars","./window","./notify","lodash","json"],function(e,t,n,r,i){var s=function(n,s){var o={data:s,url:n},a={type:"filepickerUrl",payload:o,id:e.id};e.redirect_url?window.location=e.redirect_url+"?fpurl="+encodeURI(n)+"&id="+encodeURI(e.id):(u(i.stringify(a),"*"),r.delay(function(){t.close()},1e3))},o=function(n){if(n.length===1){s(n[0].url,n[0].data);return}var o={type:"filepickerUrl",payload:n,id:e.id};u(i.stringify(o),"*"),r.delay(function(){t.close()},1e3)},u=function(t,r){if(e.redirect_url)return;var i=a(),s=window.opener||window.parent||window.top;if(!s){if(i){f(t);return}throw n.error("Can't send results to the application - sorry about this, it's our fault. Please close this window and try again."),"Parent window not found"}var o=s.frames.filepicker_comm_iframe;if(!o){if(i){f(t);return}throw n.error("Cannot send results to the application. Sorry about this, it's our fault. Please close this window and try again."),"Communication iframe not found"}o.sendMessage(t,r)},a=function(){if("localStorage"in window&&window.localStorage!==null)return!!window.localStorage.getItem("fp-message-ready")},f=function(e){var t=window.localStorage.getItem("fp-message-queue")||"[]";t=i.parse(t),t.push(e),window.localStorage.setItem("fp-message-queue",i.stringify(t))};return{sendResponse:s,sendMessage:u,sendAllResponses:o}}),define("server",["jquery","./servervars","./prettyprint","./comm","json"],function(e,t,n,r,i){var s={fetchContents:"/api/path",get:"/api/path",uploadUrl:"/api/path/url/",upload:"/api/upload/",uploadWebcam:"/api/upload/",getUrlInfo:"/api/path/url/",startMultipart:"/api/upload/multipart/start/",sendMultipart:"/api/upload/multipart/upload/",finishMultipart:"/api/upload/multipart/end/",sendEmail:"/api/path/email/",saveVideo:"/api/path/video/",echoUrl:"/api/path/echo",save:"/api/path",analytics:"/analytics/"+t.app.apikey+"/stat/",analyticsIncrement:"/analytics/"+t.app.apikey+"/stat/increment",clientUrl:"/api/client/"},o=function(){return(new Date).valueOf()},u=function(){var e=s.echoUrl+"?url="+t.saveasUrl;return t.defaultSaveasName&&(e+="&filename="+t.defaultSaveasName),e},a=!1,f=function(){return a},l=function(e){if(a!=!!e){a=!!e;var n={type:"uploading",payload:a,id:t.id+"-upload"};r.sendMessage(i.stringify(n),"*")}},c=function(e,n){n=n!==!1;var r={};r.apikey=t.app.apikey,r.mimetypes=t.mimetypes,r.folder=t.folder,r.persist=t.persist,r.version=t.version,r.storeLocation=t.storeLocation,r.storePath=t.storePath,r.storeAccess=t.storeAccess;var s=t.metadata||t.maxSize>0;return s&&(r.metadata=s),t.maxSize&&(r.maxSize=t.maxSize),t.conversions&&(r.conversions=t.conversions),t.extensions&&(r.extensions=t.extensions),t.policy&&(r.policy=t.policy,r.signature=t.signature),e?n?encodeURIComponent(i.stringify(r)):i.stringify(r):r},h=function(e,n,r,i,s){t.baseUrl&&(e=t.baseUrl+e),n.js_session||(n.js_session=c(!0,!1)),n._cachebust||(n._cachebust=o()),M({url:e,type:"GET",dataType:"json",data:n,success:function(e){var t=T(e);t.error?i(t.error):r(t.payload)},error:function(e){i(e.responseText)}},s)},p=function(e,n,r,i){var o=s.get+e.path;return function(){l(!0),h(o,{format:"fpurl"},function(r){l(!1),r.type=e.mimetype,e.filename&&(r.filename=e.filename);var i=r.url;delete r.url;var s=function(){var s=e.getMetadata();for(var o in s)r[o]=r[o]||s[o];t.maxSize&&r.size>t.maxSize?too_big(r.filename):n({url:i,data:r})};e.addOnLoad(s)},function(e){l(!1),r(e)},i||k.HIGH)}},d=function(e,r,i,s){if(e.is_dir)v(e,r,i,s);else{var o=p(e,r,i,s),u=function(e){i(e+" is too large - please specify a file less than "+n.print_size(t.maxSize))};if(t.maxSize)if(e.size!==undefined){if(e.size>t.maxSize){u(e.filename);return}o()}else e.fetchMetadata(),e.addOnLoad(function(){if(e.size>t.maxSize){u(e.filename);return}o()});else o()}},v=function(e,t,n,r){l(!0);var i=s.get+e.path;h(i,{format:"fpfolder"},function(n){l(!1);var r=n.url;delete n.url,n.filename=n.filename||e.filename,t({url:r,data:n})},function(e){n(e)},r||k.HIGH)},m=function(t,n,r,i){l(!0),r=r||function(){},i=i||function(){};var u=new FormData;u.append("fileUpload",t);var a=this,f=function(e){if(e.lengthComputable){var t=(e.loaded*100/e.total).toFixed(2);i(parseFloat(t,10))}},h=function(){var t=e.ajaxSettings.xhr();return t.upload&&t.upload.addEventListener("progress",f,!1),t},p=s.upload+"?js_session="+c(!0);p+="&_cachebust="+o(),M({url:p,type:"POST",xhr:h,success:function(e){var t=T(e);t.error?r(t.error):n(t.payload)},error:function(e){r(e.responseText)},data:u,headers:{"X-File-Name":t.name||t.fileName},dataType:"json",cache:!1,contentType:!1,processData:!1},k.MEDIUM)},g=function(e,t,n,r){l(!0),r=r||function(){};var i={js_session:c(!0,!1),url:e,_cachebust:o(),format:"fpurl"};M({url:s.uploadUrl+t,type:"GET",success:function(e){var t=T(e);t.error?r(t.error):n(t.payload)},error:function(e){r(e.responseText)},data:i,dataType:"json"},k.MEDIUM)},y=function(e,t,n,r){var i="/api/client/"+e+"/login/";i+="?_cachebust="+o(),M({type:"POST",url:i,data:{formdata:t},success:function(e){var t=T(e);t.error?r(t.error):n(t.payload)},error:function(e){e&&e.reqponseText?(response=json.parse(e.responsetext),message=response.error.msg,r(message)):r()},dataType:"json"},k.HIGH)},b=function(e,t,n,r,i,u){var a={};a.from=e,a.to=t,a.message=n,a.filename=r.filename,a.url=r.url,a.js_session=c(!0);var f=s.sendEmail;f+="?_cachebust="+o(),M({type:"POST",url:f,data:a,dataType:"json",success:function(e){var t=T(e);t.error?u(t.error):i(t.payload)},error:function(e){u(e.responseText)}},k.HIGH)},w=function(e,n,r,i){var u={};u.js_session=c(!0),u.url=t.saveasUrl,u.overwrite=!!n;var a=s.save+e;a+="?_cachebust="+o(),l(!0),M({type:"POST",url:a,data:u,dataType:"json",success:function(e){l(!1);var t=T(e);t.error?i(t.error):r(t.payload)},error:function(e){l(!1),i("Oops! Looks like there was an error saving your file. The bugscrubbers have been notified.")}},k.HIGH)},E=function(e,t,n){var r={};r.name=e.name||e.fileName,r.size=e.size,r.js_session=c(!0);var i=s.startMultipart;i+="?_cachebust="+o(),M({type:"POST",url:i,data:r,dataType:"json",success:function(e){var r=T(e);r.error?n(r.error):t(r.payload)},error:function(e){n(e.responseText)}},k.HIGH)},S=function(t,n,r,i,u,a){u=u||function(){},a=a||function(){};var f=s.sendMultipart+"?id="+t+"&index="+n+"&js_session="+c(!0);f+="&_cachebust="+o();var l=function(){var e=0;return function(t){if(t.lengthComputable){var n=((t.loaded-e)*100/t.total).toFixed(2);a(parseFloat(n,10)),e=t.loaded}return!0}},h=function(){var t=e.ajaxSettings.xhr();return t.upload&&t.upload.addEventListener("progress",l(),!1),t};data=new FormData,data.append("fileUpload",r),M({url:f,type:"POST",data:data,dataType:"json",xhr:h,success:function(e){var t=T(e);t.error?u(t.error):i(t.payload)},error:function(e){u(e.responseText)},cache:!1,contentType:!1,processData:!1},k.LOW)},x=function(e,t,n,r){var i=s.finishMultipart;i+="?_cachebust="+o(),M({type:"POST",url:i,data:{id:e,total:t,js_session:c(!0)},dataType:"json",success:function(e){var t=T(e);t.error?r(t.error):n(t.payload)},error:function(e){r(e.responseText)}},k.MEDIUM)},T=function(e){var t={};return e.error?t.error=e.error:e.result=="error"?t.error=e.message:e.result=="ok"&&e.data?t.payload=e.data:e.result=="success"&&e.data?t.payload=e.data:t.payload=e,t},N=function(t,n){n==undefined&&(n=1),e.post(s.analyticsIncrement,{stat:t,count:n})},C={},k={HIGH:1,MEDIUM:2,LOW:3};C[k.LOW]=[],C[k.MEDIUM]=[],C[k.HIGH]=[];var L=function(e){this.job=e,this.current_connections=0,this.max_connections=6,this.next=function(){this.current_connections<this.max_connections&&this.job()},this.take=function(){this.current_connections++},this.release=function(){this.current_connections--,this.next()}},A=function(){var t=C[k.HIGH].length>0?k.HIGH:C[k.MEDIUM].length>0?k.MEDIUM:C[k.LOW].length>0?k.LOW:undefined;t&&e.ajax(C[t].shift())},O=new L(A),M=function(e,t){t=t||k.MEDIUM,C[t].push(e),O.next()};return e(document).ajaxComplete(function(){O.release()}),e(document).ajaxSend(function(){O.take()}),{getJSON:h,getJsSession:c,urls:s,isUploading:f,setUploading:l,massageResponse:T,getEchoUrl:u,uploadPathObject:d,uploadFile:m,uploadUrl:g,loginClient:y,sendEmail:b,saveFile:w,startMultipartUpload:E,sendMultipartChunk:S,finishMultipartUpload:x,incrementStat:N,priority:k}}),define("multipart_uploader",["./server"],function(e){var t={};t.BASE_CHUNK_SIZE=1048576,t.MAX_PARALLEL_REQUESTS=10,t.MIN_PARALLEL_REQUESTS=5,t.MAX_RETRIES=10,t.FROZEN_TIMEOUT=15e3,t.MAX_CHUNKS=1e3;var n=function(e){return this instanceof n?(this.onSuccessHandler=function(){},this.onErrorHandler=function(){},this.onProgressHandler=function(){},this.file=e,this.retry=!0,this.retries={},this.chunkSize=Math.ceil(Math.max(o,this.file.size/t.MAX_CHUNKS)),this.chunksUploaded=0,this.total=Math.ceil(this.file.size/this.chunkSize),this.currentProgress=0,this):new n(e)};n.prototype.setRetry=function(e){this.retry=e},n.prototype.stop=function(){this.running=!1},n.prototype.start=function(){this.running=!0,this.sendNextChunk()},n.prototype.reset=function(){this.retries={},this.nextChunk=this.getChunkIterator(),this.currentRequestCount=0,this.multipartId=undefined},n.prototype.setOnSuccess=function(e){this.onSuccessHandler=e},n.prototype.setOnError=function(e){this.onErrorHandler=e},n.prototype.setOnProgress=function(e){this.onProgressHandler=e},n.prototype.upload=function(){this.running=!0,this.startMultipartUpload()},n.prototype.startMultipartUpload=function(){e.setUploading(!0);var n=this;e.startMultipartUpload(this.file,function(e){n.multipartId=e.id,n.nextChunk=n.getChunkIterator(),n.currentRequestCount=0;for(var r=0;r<t.MAX_PARALLEL_REQUESTS;r++)n.sendNextChunk()},function(e){e&&e.msg&&(e=e.msg),n.onError(0,null,e)})},n.prototype.sendNextChunk=function(){if(!this.running)return;var e=this;setTimeout(function(){if(e.currentRequestCount>=t.MAX_PARALLEL_REQUESTS){e.checkIfFrozen();return}e.markAsThawed();var n=e.nextChunk();if(n[1]===null)return;e.uploadChunk(n[0],n[1]),e.currentRequestCount<t.MIN_PARALLEL_REQUESTS&&e.sendNextChunk()},1)},n.prototype.checkIfFrozen=function(){var e=this;this.markAsThawed(),this.frozen_timeout=window.setTimeout(function(){e.frozen_timeout=undefined,e.currentRequestCount>=t.MAX_PARALLEL_REQUESTS&&(e.currentRequestCount/=2,e.sendNextChunk())},t.FROZEN_TIMEOUT)},n.prototype.markAsThawed=function(){this.frozen_timeout&&(window.clearTimeout(this.frozen_timeout),this.frozen_timeout=undefined)},n.prototype.getChunkIterator=function(){return function(e){var t=0,n;return e.file.slice?$.browser.mozilla&&parseInt($.browser.version,10)<13?n=function(){return e.file.slice(t*e.chunkSize,e.chunkSize)}:n=function(){return e.file.slice(t*e.chunkSize,(t+1)*e.chunkSize)}:e.file.mozSlice?n=function(t){return e.file.mozSlice(t*e.chunkSize,(t+1)*e.chunkSize)}:e.file.webkitSlice?n=function(t){return e.file.webkitSlice(t*e.chunkSize,(t+1)*e.chunkSize)}:(e.total=1,n=function(t){return e.file}),function(){return t>=e.total?[-1,null]:(part=n(t),t++,[t,part])}}(this)},n.prototype.uploadChunk=function(t,n){this.currentRequestCount++;var r=this;e.sendMultipartChunk(this.multipartId,t,n,function(e){r.onChunkComplete(t,n)},function(e){r.onChunkError(t,n,e)},r.onChunkProgress())},n.prototype.onChunkProgress=function(){var e=this;return function(t){e.currentProgress+=t/e.total*.9,e.onProgress(e.currentProgress)}},n.prototype.onChunkComplete=function(t,n){this.chunksUploaded++;var r=this;if(this.chunksUploaded===this.total){var i=0,s=window.setInterval(function(){i++;var e=i/r.total*.1*100+90;e=Math.min(e,99.3),r.onProgress(e)},4e3);e.finishMultipartUpload(this.multipartId,this.total,function(e){window.clearInterval(s),r.onSuccess(e)},function(e){r.onError(0,null,e)})}this.currentRequestCount--,this.sendNextChunk()},n.prototype.onChunkError=function(e,n,r){this.currentRequestCount--,this.retries[e]||(this.retries[e]=0),this.retries[e]++,this.retries[e]>t.MAX_RETRIES?(this.onError(e,n,r),this.stop()):this.uploadChunk(e,n)},n.prototype.onProgress=function(e){this.onProgressHandler(parseFloat(e.toFixed(2),10))},n.prototype.onError=function(e,t,n){this.onErrorHandler(n)},n.prototype.onSuccess=function(e){this.nextChunk=undefined,this.onSuccessHandler(e)};var r=!0,i=function(e){var t=window.navigator.userAgent,n=t.indexOf("Android")>=0&&t.indexOf("Chrome")==-1;return r&&File&&(File.prototype.slice||File.prototype.webkitSlice||File.prototype.mozSlize)&&!n},s=function(e){r=e},o=t.BASE_CHUNK_SIZE,u=function(){return o},a=function(e){o=e};return{MultipartUploader:n,getChunkSize:u,setChunkSize:a,isEnabled:i,setEnabled:s}}),define("html5uploader",["./server","./multipart_uploader","./servervars","jquery"],function(e,t,n,r){var i=function(e,t,n){return this instanceof i?(this.form=e,this.fileinput=t,this.retry=n!==!1,this.retries={},this.max_retries=10,this.beforeAll=function(){},this.onStart=function(){},this.onSuccessHandler=function(){},this.onErrorHandler=function(){},this.onProgressHandler=function(){},this.afterAllHandler=function(){},this.checkValid=function(){return!0},this.count=0,this.left=0,this.initialize(),this):new i(e,t,n)};i.prototype.initialize=function(){var e=this;if(!this.fileinput)return!1;var t=function(){return setTimeout(function(){e.uploadFiles(e.fileinput.files)},1),!1};this.fileinput.onchange=function(){if(!this.value)return!1;var n=this.files;return e.checkValid(n)?(this.setAttribute("disabled","disabled"),t(),!0):!1};if(this.form){var n=r(this.form);n.submit(t)}return!0},i.prototype.uploadFiles=function(t){if(!this.checkValid(t))return!1;e.setUploading(!0),this.beforeAll();var n;for(var r=0;r<t.length;r++){n=t[r],n.name=n.name||n.filename;if(this.onStart(n,r)===!1)continue;this.count++,this.left++,this.upload(n,r)}return!0},i.prototype.upload=function(e,n){t.isEnabled()&&e.size>t.getChunkSize()?this.multipartUpload(e,n):this.standardUpload(e,n)},i.prototype.multipartUpload=function(e,n){var r=t.MultipartUploader(e),i=this;r.setOnSuccess(function(t){i.onSuccess(e,n,t)}),r.setOnError(function(t){i.onError(e,n,t)}),r.setOnProgress(function(t){i.onProgress(e,n,t.toFixed(2))}),r.setRetry(this.retry),r.upload()},i.prototype.standardUpload=function(t,n){var r=this;e.uploadFile(t,function(e){r.onSuccess(t,n,e)},function(e){r.onError(t,n,e)},function(e){r.onProgress(t,n,e)})},i.prototype.onSuccess=function(e,t,n){this.left--,n=n[0],this.onSuccessHandler(e,t,n),this.left===0&&this.afterAll()},i.prototype.onError=function(e,t,n){n=n||{msg:"Error Uploading",noretry:!1};if(this.retry&&!n.noretry){this.retries[t]||(this.retries[t]=0),this.retries[t]++;if(this.retries[t]<=this.max_retries){this.upload(e,t);return}}this.left--,this.hadError=!0,this.onErrorHandler(e,t,"server_error",n.msg||n),this.left===0&&this.afterAll()},i.prototype.onProgress=function(e,t,n){if(this.retries[t]>0)return;this.onProgressHandler(e,t,n)},i.prototype.afterAll=function(){e.setUploading(!1),this.fileinput.removeAttribute("disabled"),this.retries={},this.count=0,this.afterAllHandler(!this.hadError),this.hadError=!1},i.prototype.setBeforeAllListener=function(e){this.beforeAll=e},i.prototype.setOnStartListener=function(e){this.onStart=e},i.prototype.setOnSuccessListener=function(e){this.onSuccessHandler=e},i.prototype.setOnErrorListener=function(e){this.onErrorHandler=e},i.prototype.setOnProgressListener=function(e){this.onProgressHandler=e},i.prototype.setAfterAllListener=function(e){this.afterAllHandler=e},i.prototype.setValidChecker=function(e){this.checkValid=e};var s=!0,o=function(){var e=s&&!!window.FormData&&!!window.XMLHttpRequest&&"upload"in new XMLHttpRequest;return n.multiple&&r.browser.safari&&window.navigator.userAgent.toLowerCase().indexOf("windows")>=0&&(e=!1),e},u=function(e){s=e};return{HTML5Uploader:i,isEnabled:o,setEnabled:u}}),define("extension_mimetype_map",[],function(){return{".stl":"applicaiton/sla",".hbs":"text/html",".imp":"application/x-impressionist",".obj":"application/octet-stream",".ra":"audio/x-pn-realaudio",".wsdl":"application/xml",".dll":"application/octet-stream",".ras":"image/x-cmu-raster",".ram":"application/x-pn-realaudio",".bcpio":"application/x-bcpio",".sh":"application/x-sh",".m1v":"video/mpeg",".xwd":"image/x-xwindowdump",".doc":"application/msword",".bmp":"image/x-ms-bmp",".shar":"application/x-shar",".js":"application/x-javascript",".src":"application/x-wais-source",".dvi":"application/x-dvi",".aif":"audio/x-aiff",".ksh":"text/plain",".csv":"text/csv",".dot":"application/msword",".mht":"message/rfc822",".p12":"application/x-pkcs12",".css":"text/css",".csh":"application/x-csh",".pwz":"application/vnd.ms-powerpoint",".pdf":"application/pdf",".cdf":"application/x-netcdf",".pl":"text/plain",".ai":"application/postscript",".jpe":"image/jpeg",".jpg":"image/jpeg",".py":"text/x-python",".xml":"text/xml",".jpeg":"image/jpeg",".ps":"application/postscript",".gtar":"application/x-gtar",".xpm":"image/x-xpixmap",".hdf":"application/x-hdf",".nws":"message/rfc822",".tsv":"text/tab-separated-values",".xpdl":"application/xml",".p7c":"application/pkcs7-mime",".eps":"application/postscript",".ief":"image/ief",".so":"application/octet-stream",".xlb":"application/vnd.ms-excel",".pbm":"image/x-portable-bitmap",".texinfo":"application/x-texinfo",".xls":"application/vnd.ms-excel",".tex":"application/x-tex",".rtx":"text/richtext",".html":"text/html",".aiff":"audio/x-aiff",".aifc":"audio/x-aiff",".exe":"application/octet-stream",".sgm":"text/x-sgml",".tif":"image/tiff",".mpeg":"video/mpeg",".ustar":"application/x-ustar",".gif":"image/gif",".ppt":"application/vnd.ms-powerpoint",".pps":"application/vnd.ms-powerpoint",".sgml":"text/x-sgml",".ppm":"image/x-portable-pixmap",".latex":"application/x-latex",".bat":"text/plain",".mov":"video/quicktime",".ppa":"application/vnd.ms-powerpoint",".tr":"application/x-troff",".rdf":"application/xml",".xsl":"application/xml",".eml":"message/rfc822",".nc":"application/x-netcdf",".sv4cpio":"application/x-sv4cpio",".bin":"application/octet-stream",".h":"text/plain",".tcl":"application/x-tcl",".wiz":"application/msword",".o":"application/octet-stream",".a":"application/octet-stream",".c":"text/plain",".wav":"audio/x-wav",".vcf":"text/x-vcard",".xbm":"image/x-xbitmap",".txt":"text/plain",".au":"audio/basic",".t":"application/x-troff",".tiff":"image/tiff",".texi":"application/x-texinfo",".oda":"application/oda",".ms":"application/x-troff-ms",".rgb":"image/x-rgb",".me":"application/x-troff-me",".sv4crc":"application/x-sv4crc",".qt":"video/quicktime",".mpa":"video/mpeg",".mpg":"video/mpeg",".mpe":"video/mpeg",".avi":"video/x-msvideo",".pgm":"image/x-portable-graymap",".pot":"application/vnd.ms-powerpoint",".mif":"application/x-mif",".roff":"application/x-troff",".htm":"text/html",".man":"application/x-troff-man",".etx":"text/x-setext",".zip":"application/zip",".movie":"video/x-sgi-movie",".pyc":"application/x-python-code",".png":"image/png",".pfx":"application/x-pkcs12",".mhtml":"message/rfc822",".tar":"application/x-tar",".pnm":"image/x-portable-anymap",".pyo":"application/x-python-code",".snd":"audio/basic",".cpio":"application/x-cpio",".swf":"application/x-shockwave-flash",".mp3":"audio/mpeg",".mp2":"audio/mpeg",".mp4":"video/mp4"}}),define("mimetype_extension_map",[],function(){return{"*/*":"*.*","application/*":"*.zirz;*.obd;*.obj;*.cryptonote;*.pml;*.iso;*.hvs;*.rar;*.mrc;*.sdkd;*.bcpio;*.sdkm;*.list3820;*.bz;*.onetoc2;*.ait;*.onetmp;*.geo;*.air;*.bmi;*.xhvml;*.dvi;*.eps;*.hpid;*.ott;*.rss;*.ots;*.hlp;*.cst;*.p10;*.p12;*.csp;*.sus;*.otg;*.otf;*.csh;*.otc;*.pdb;*.clkp;*.pdf;*.hal;*.atomsvc;*.xul;*.chm;*.ttf;*.xml;*.ps;*.fig;*.sig;*.cab;*.xlm;*.ltf;*.xlb;*.prc;*.pre;*.prf;*.car;*.tsd;*.dd2;*.cat;*.dms;*.sc;*.mp4s;*.c4d;*.c4g;*.c4f;*.texinfo;*.p8;*.dmg;*.c4p;*.c4u;*.vis;*.ddd;*.link66;*.tmo;*.ext;*.exi;*.mus;*.opf;*.exe;*.xpw;*.xpr;*.xps;*.xpx;*.mscml;*.rep;*.m21;*.sisx;*.spq;*.fxpl;*.ami;*.fm;*.dssc;*.spf;*.xlt;*.spc;*.spl;*.bat;*.mgp;*.emma;*.gac;*.cww;*.efif;*.yin;*.wad;*.saf;*.txf;*.utz;*.txd;*.rsd;*.mxml;*.xsm;*.jlt;*.xbd;*.mlp;*.qxd;*.twd;*.dna;*.distz;*.ahead;*.smil;*.fnc;*.et3;*.daf;*.cer;*.smf;*.ufd;*.dotm;*.smi;*.pub;*.gxt;*.jisp;*.sfs;*.imp;*.mpn;*.dxp;*.tar;*.mqy;*.rnc;*.tao;*.xlsx;*.wgt;*.hpgl;*.dotx;*.cu;*.chrt;*.wsdl;*.fg5;*.gex;*.ei6;*.xlsb;*.mcd;*.odft;*.nnd;*.pgn;*.mwf;*.str;*.g2w;*.stw;*.sti;*.nns;*.stk;*.crl;*.ipfix;*.stl;*.semf;*.bed;*.stc;*.crd;*.std;*.stf;*.gmx;*.fgd;*.dp;*.mrcx;*.cla;*.pwn;*.pskcxml;*.wmf;*.wmd;*.wmz;*.clp;*.rp9;*.mc1;*.m13;*.m14;*.dist;*.nml;*.kpt;*.kpr;*.g3w;*.oa2;*.oa3;*.gtar;*.p7m;*.deb;*.p7c;*.p7b;*.bpk;*.ez;*.der;*.p7s;*.p7r;*.fxp;*.acc;*.bdf;*.c11amz;*.ace;*.listafp;*.dfac;*.acu;*.wmlsc;*.oas;*.c11amc;*.tex;*.wri;*.irp;*.ecma;*.sse;*.ssf;*.sitx;*.oth;*.tei;*.meta4;*.irm;*.joda;*.rpst;*.fdf;*.elc;*.eot;*.rpss;*.hps;*.mfm;*.paw;*.lrf;*.gim;*.kfo;*.ims;*.lrm;*.cdkey;*.atomcat;*.qwd;*.i2g;*.rtf;*.twds;*.dxr;*.azw;*.qxt;*.azs;*.iif;*.sv4cpio;*.ngdat;*.azf;*.com;*.wbxml;*.mathml;*.wiz;*.vcd;*.vcg;*.json;*.shf;*.cdbcmsg;*.tpt;*.psb;*.vxml;*.psf;*.tpl;*.htke;*.vcx;*.teicorpus;*.xhtml;*.cdmio;*.texi;*.oda;*.ustar;*.ssml;*.odb;*.m3u8;*.cdmid;*.see;*.cdmia;*.fcs;*.mpkg;*.odt;*.odp;*.ods;*.cdmiq;*.mpm;*.mpc;*.xdssc;*.mpy;*.pot;*.umj;*.wpd;*.tfi;*.mpp;*.tfm;*.xspf;*.nsf;*.wmlc;*.ggb;*.dpg;*.fzs;*.ggt;*.onetoc;*.kon;*.karbon;*.pfx;*.mseq;*.ivp;*.ivu;*.pfr;*.yang;*.swa;*.swf;*.swi;*.sldm;*.pfa;*.pfb;*.hvp;*.rm;*.rl;*.pkg;*.sbml;*.seed;*.book;*.wcm;*.sxd;*.rs;*.ppam;*.rq;*.sxg;*.xop;*.skd;*.xdf;*.sis;*.skm;*.osfpvg;*.skt;*.skp;*.ufdl;*.cct;*.hqx;*.ksp;*.sit;*.doc;*.srx;*.wps;*.shar;*.ptid;*.cxt;*.ccxml;*.dot;*.cdy;*.slt;*.vor;*.vox;*.ktr;*.qps;*.gsf;*.icm;*.uoml;*.icc;*.ktz;*.cdf;*.ai;*.deploy;*.grv;*.esf;*.abw;*.wspolicy;*.epub;*.pki;*.hdf;*.davmount;*.xpdl;*.src;*.zaz;*.bdm;*.wqd;*.mobipocket-ebook;*.box;*.sru;*.boz;*.oxt;*.pbd;*.bh2;*.pptx;*.es3;*.qbo;*.msty;*.dtd;*.dtb;*.pclxl;*.xdp;*.xdw;*.onepkg;*.mobi;*.mbk;*.cdxml;*.ipk;*.org;*.gre;*.xslt;*.xdm;*.gqf;*.mp21;*.kne;*.edx;*.flw;*.odg;*.susp;*.ez3;*.ez2;*.gqs;*.nbp;*.hbci;*.pkipath;*.uvvd;*.odc;*.uvvf;*.sema;*.ppt;*.pps;*.odm;*.lzh;*.xvm;*.latex;*.semd;*.ppd;*.ppa;*.igl;*.mbox;*.lwp;*.osf;*.odi;*.kwt;*.dcr;*.oti;*.cdmic;*.igx;*.kwd;*.apr;*.crt;*.n-gage;*.tcl;*.ogx;*.flo;*.jam;*.rld;*.bz2;*.xar;*.jar;*.cpt;*.afp;*.application;*.mxf;*.mxl;*.mxs;*.gram;*.mb;*.ma;*.qam;*.afm;*.thmx;*.mseed;*.pcurl;*.ser;*.portpkg;*.vsf;*.res;*.pgp;*.svc;*.nlu;*.svd;*.atom;*.qfx;*.unityweb;*.123;*.xlsm;*.uvd;*.xbap;*.uvf;*.frame;*.uvt;*.lostxml;*.uvx;*.mag;*.pyc;*.atx;*.dataless;*.apk;*.mny;*.pyo;*.ghf;*.cpio;*.setreg;*.atc;*.xpi;*.jnlp;*.dll;*.rif;*.scq;*.scs;*.scm;*.xfdl;*.scd;*.wdb;*.xfdf;*.xlam;*.aab;*.sda;*.aam;*.sdc;*.sdd;*.js;*.aas;*.sdp;*.sdw;*.plb;*.plc;*.plf;*.lha;*.edm;*.wtb;*.msf;*.pls;*.knp;*.msl;*.mpt;*.qxb;*.msi;*.oprc;*.pcf;*.xla;*.potm;*.7z;*.pcl;*.mdb;*.cmp;*.potx;*.zir;*.zip;*.vss;*.clkk;*.ppsx;*.vsw;*.class;*.torrent;*.mmf;*.xer;*.asc;*.qxl;*.vsd;*.clkx;*.clkw;*.xo;*.clkt;*.aso;*.pwz;*.sh;*.sm;*.hvd;*.so;*.wbs;*.xlc;*.tcap;*.sfd-hdstx;*.xls;*.cii;*.st;*.xlw;*.cil;*.spp;*.wks;*.gtm;*.trm;*.ppsm;*.woff;*.kia;*.odf;*.tra;*.fsc;*.ifm;*.sgl;*.musicxml;*.lbd;*.lbe;*.maker;*.otp;*.qwt;*.mvb;*.les;*.rms;*.uvvt;*.mets;*.dir;*.acutc;*.rdf;*.xsl;*.sxw;*.nc;*.nb;*.sxm;*.uvvx;*.sxi;*.aep;*.bin;*.rdz;*.sxc;*.ac;*.pptm;*.itp;*.xltm;*.o;*.a;*.rcprofile;*.udeb;*.fe_launch;*.xltx;*.aw;*.wpl;*.xenc;*.gnumeric;*.mods;*.docm;*.nnw;*.xvml;*.x3d;*.xap;*.igm;*.sldx;*.ttc;*.docx;*.zmm;*.sv4crc;*.cmc;*.pfm;*.u32;*.pvb;*.mgz;*.mif;*.chat;*.kml;*.dump;*.gph;*.xht;*.grxml;*.ncx;*.wg;*.kmz;*.x32;*.teacher;*.dis;*.vst;*.setpay;*.cod;*.w3d;*.snf;*.mmd;*.lasxml;*.ftc;*.pqa;*.fti;*.mads;","application/acrobat":"*.pdf;","application/andrew-inset":"*.ez;","application/applixware":"*.aw;","application/atom+xml":"*.atom;","application/atomcat+xml":"*.atomcat;","application/atomsvc+xml":"*.atomsvc;","application/ccxml+xml":"*.ccxml;","application/cdmi-capability":"*.cdmia;","application/cdmi-container":"*.cdmic;","application/cdmi-domain":"*.cdmid;","application/cdmi-object":"*.cdmio;","application/cdmi-queue":"*.cdmiq;","application/cu-seeme":"*.cu;","application/davmount+xml":"*.davmount;","application/dssc+der":"*.dssc;","application/dssc+xml":"*.xdssc;","application/ecmascript":"*.ecma;","application/emma+xml":"*.emma;","application/epub+zip":"*.epub;","application/exi":"*.exi;","application/font-tdpfr":"*.pfr;","application/hyperstudio":"*.stk;","application/ipfix":"*.ipfix;","application/java-archive":"*.jar;","application/java-serialized-object":"*.ser;","application/java-vm":"*.class;","application/javascript":"*.js;","application/json":"*.json;","application/lost+xml":"*.lostxml;","application/mac-binhex40":"*.hqx;","application/mac-compactpro":"*.cpt;","application/mads+xml":"*.mads;","application/marc":"*.mrc;","application/marcxml+xml":"*.mrcx;","application/mathematica":"*.mb;*.ma;*.nb;","application/mathml+xml":"*.mathml;","application/mbox":"*.mbox;","application/mediaservercontrol+xml":"*.mscml;","application/metalink4+xml":"*.meta4;","application/mets+xml":"*.mets;","application/mods+xml":"*.mods;","application/mp21":"*.m21;*.mp21;","application/mp4":"*.mp4s;","application/msword":"*.wiz;*.doc;*.dot;","application/mxf":"*.mxf;","application/octet-stream":"*.obj;*.iso;*.dms;*.dmg;*.distz;*.dist;*.bpk;*.elc;*.lrf;*.pkg;*.deploy;*.mobipocket-ebook;*.lzh;*.lha;*.so;*.bin;*.o;*.a;*.dump;","application/oda":"*.oda;","application/oebps-package+xml":"*.opf;","application/ogg":"*.ogx;","application/onenote":"*.onetoc2;*.onetmp;*.onetoc;*.onepkg;","application/patch-ops-error+xml":"*.xer;","application/pdf":"*.pdf;","application/pgp-encrypted":"*.pgp;","application/pgp-signature":"*.sig;*.asc;","application/pics-rules":"*.prf;","application/pkcs10":"*.p10;","application/pkcs7-mime":"*.p7m;*.p7c;","application/pkcs7-signature":"*.p7s;","application/pkcs8":"*.p8;","application/pkix-attr-cert":"*.ac;","application/pkix-cert":"*.cer;","application/pkix-crl":"*.crl;","application/pkix-pkipath":"*.pkipath;","application/pkixcmp":"*.pki;","application/pls+xml":"*.pls;","application/postscript":"*.eps;*.ps;*.ai;","application/prs.cww":"*.cww;","application/pskc+xml":"*.pskcxml;","application/rdf+xml":"*.rdf;","application/reginfo+xml":"*.rif;","application/relax-ng-compact-syntax":"*.rnc;","application/resource-lists+xml":"*.rl;","application/resource-lists-diff+xml":"*.rld;","application/rls-services+xml":"*.rs;","application/rsd+xml":"*.rsd;","application/rss+xml":"*.rss;","application/rtf":"*.rtf;","application/sbml+xml":"*.sbml;","application/scvp-cv-request":"*.scq;","application/scvp-cv-response":"*.scs;","application/scvp-vp-request":"*.spq;","application/scvp-vp-response":"*.spp;","application/sdp":"*.sdp;","application/set-payment-initiation":"*.setpay;","application/set-registration-initiation":"*.setreg;","application/shf+xml":"*.shf;","application/smil+xml":"*.smil;*.smi;","application/sparql-query":"*.rq;","application/sparql-results+xml":"*.srx;","application/srgs":"*.gram;","application/srgs+xml":"*.grxml;","application/sru+xml":"*.sru;","application/ssml+xml":"*.ssml;","application/tei+xml":"*.tei;*.teicorpus;","application/thraud+xml":"*.tfi;","application/timestamped-data":"*.tsd;","application/vnd.3gpp.pic-bw-large":"*.plb;","application/vnd.3gpp.pic-bw-small":"*.psb;","application/vnd.3gpp.pic-bw-var":"*.pvb;","application/vnd.3gpp2.tcap":"*.tcap;","application/vnd.3m.post-it-notes":"*.pwn;","application/vnd.accpac.simply.aso":"*.aso;","application/vnd.acucobol":"*.acu;","application/vnd.acucorp":"*.atc;*.acutc;","application/vnd.adobe.air-application-installer-package+zip":"*.air;","application/vnd.adobe.fxp":"*.fxpl;*.fxp;","application/vnd.adobe.xdp+xml":"*.xdp;","application/vnd.adobe.xfdf":"*.xfdf;","application/vnd.ahead.space":"*.ahead;","application/vnd.airzip.filesecure.azf":"*.azf;","application/vnd.airzip.filesecure.azs":"*.azs;","application/vnd.amazon.ebook":"*.azw;","application/vnd.americandynamics.acc":"*.acc;","application/vnd.amiga.ami":"*.ami;","application/vnd.android.package-archive":"*.apk;","application/vnd.anser-web-certificate-issue-initiation":"*.cii;","application/vnd.anser-web-funds-transfer-initiation":"*.fti;","application/vnd.antix.game-component":"*.atx;","application/vnd.apple.installer+xml":"*.mpkg;","application/vnd.aristanetworks.swi":"*.swi;","application/vnd.audiograph":"*.aep;","application/vnd.blueice.multipass":"*.mpm;","application/vnd.bmi":"*.bmi;","application/vnd.businessobjects":"*.rep;","application/vnd.chemdraw+xml":"*.cdxml;","application/vnd.chipnuts.karaoke-mmd":"*.mmd;","application/vnd.cinderella":"*.cdy;","application/vnd.claymore":"*.cla;","application/vnd.cloanto.rp9":"*.rp9;","application/vnd.clonk.c4group":"*.c4d;*.c4g;*.c4f;*.c4p;*.c4u;","application/vnd.cluetrust.cartomobile-config":"*.c11amc;","application/vnd.cluetrust.cartomobile-config-pkg":"*.c11amz;","application/vnd.commonspace":"*.csp;","application/vnd.contact.cmsg":"*.cdbcmsg;","application/vnd.cosmocaller":"*.cmc;","application/vnd.crick.clicker":"*.clkx;","application/vnd.crick.clicker.keyboard":"*.clkk;","application/vnd.crick.clicker.palette":"*.clkp;","application/vnd.crick.clicker.template":"*.clkt;","application/vnd.crick.clicker.wordbank":"*.clkw;","application/vnd.criticaltools.wbs+xml":"*.wbs;","application/vnd.ctc-posml":"*.pml;","application/vnd.cups-ppd":"*.ppd;","application/vnd.curl.car":"*.car;","application/vnd.curl.pcurl":"*.pcurl;","application/vnd.data-vision.rdz":"*.rdz;","application/vnd.dece.data":"*.uvvd;*.uvvf;*.uvd;*.uvf;","application/vnd.dece.ttml+xml":"*.uvt;*.uvvt;","application/vnd.dece.unspecified":"*.uvx;*.uvvx;","application/vnd.denovo.fcselayout-link":"*.fe_launch;","application/vnd.dna":"*.dna;","application/vnd.dolby.mlp":"*.mlp;","application/vnd.dpgraph":"*.dpg;","application/vnd.dreamfactory":"*.dfac;","application/vnd.dvb.ait":"*.ait;","application/vnd.dvb.service":"*.svc;","application/vnd.dynageo":"*.geo;","application/vnd.ecowin.chart":"*.mag;","application/vnd.enliven":"*.nml;","application/vnd.epson.esf":"*.esf;","application/vnd.epson.msf":"*.msf;","application/vnd.epson.quickanime":"*.qam;","application/vnd.epson.salt":"*.slt;","application/vnd.epson.ssf":"*.ssf;","application/vnd.eszigno3+xml":"*.et3;*.es3;","application/vnd.ezpix-album":"*.ez2;","application/vnd.ezpix-package":"*.ez3;","application/vnd.fdf":"*.fdf;","application/vnd.fdsn.mseed":"*.mseed;","application/vnd.fdsn.seed":"*.seed;*.dataless;","application/vnd.flographit":"*.gph;","application/vnd.fluxtime.clip":"*.ftc;","application/vnd.framemaker":"*.fm;*.book;*.frame;*.maker;","application/vnd.frogans.fnc":"*.fnc;","application/vnd.frogans.ltf":"*.ltf;","application/vnd.fsc.weblaunch":"*.fsc;","application/vnd.fujitsu.oasys":"*.oas;","application/vnd.fujitsu.oasys2":"*.oa2;","application/vnd.fujitsu.oasys3":"*.oa3;","application/vnd.fujitsu.oasysgp":"*.fg5;","application/vnd.fujitsu.oasysprs":"*.bh2;","application/vnd.fujixerox.ddd":"*.ddd;","application/vnd.fujixerox.docuworks":"*.xdw;","application/vnd.fujixerox.docuworks.binder":"*.xbd;","application/vnd.fuzzysheet":"*.fzs;","application/vnd.genomatix.tuxedo":"*.txd;","application/vnd.geogebra.file":"*.ggb;","application/vnd.geogebra.tool":"*.ggt;","application/vnd.geometry-explorer":"*.gex;*.gre;","application/vnd.geonext":"*.gxt;","application/vnd.geoplan":"*.g2w;","application/vnd.geospace":"*.g3w;","application/vnd.gmx":"*.gmx;","application/vnd.google-earth.kml+xml":"*.kml;","application/vnd.google-earth.kmz":"*.kmz;","application/vnd.grafeq":"*.gqf;*.gqs;","application/vnd.groove-account":"*.gac;","application/vnd.groove-help":"*.ghf;","application/vnd.groove-identity-message":"*.gim;","application/vnd.groove-injector":"*.grv;","application/vnd.groove-tool-message":"*.gtm;","application/vnd.groove-tool-template":"*.tpl;","application/vnd.groove-vcard":"*.vcg;","application/vnd.hal+xml":"*.hal;","application/vnd.handheld-entertainment+xml":"*.zmm;","application/vnd.hbci":"*.hbci;","application/vnd.hhe.lesson-player":"*.les;","application/vnd.hp-hpgl":"*.hpgl;","application/vnd.hp-hpid":"*.hpid;","application/vnd.hp-hps":"*.hps;","application/vnd.hp-jlyt":"*.jlt;","application/vnd.hp-pcl":"*.pcl;","application/vnd.hp-pclxl":"*.pclxl;","application/vnd.hydrostatix.sof-data":"*.sfd-hdstx;","application/vnd.hzn-3d-crossword":"*.x3d;","application/vnd.ibm.minipay":"*.mpy;","application/vnd.ibm.modcap":"*.list3820;*.listafp;*.afp;","application/vnd.ibm.rights-management":"*.irm;","application/vnd.ibm.secure-container":"*.sc;","application/vnd.iccprofile":"*.icm;*.icc;","application/vnd.igloader":"*.igl;","application/vnd.immervision-ivp":"*.ivp;","application/vnd.immervision-ivu":"*.ivu;","application/vnd.insors.igm":"*.igm;","application/vnd.intercon.formnet":"*.xpw;*.xpx;","application/vnd.intergeo":"*.i2g;","application/vnd.intu.qbo":"*.qbo;","application/vnd.intu.qfx":"*.qfx;","application/vnd.ipunplugged.rcprofile":"*.rcprofile;","application/vnd.irepository.package+xml":"*.irp;","application/vnd.is-xpr":"*.xpr;","application/vnd.isac.fcs":"*.fcs;","application/vnd.jam":"*.jam;","application/vnd.jcp.javame.midlet-rms":"*.rms;","application/vnd.jisp":"*.jisp;","application/vnd.joost.joda-archive":"*.joda;","application/vnd.kahootz":"*.ktr;*.ktz;","application/vnd.kde.karbon":"*.karbon;","application/vnd.kde.kchart":"*.chrt;","application/vnd.kde.kformula":"*.kfo;","application/vnd.kde.kivio":"*.flw;","application/vnd.kde.kontour":"*.kon;","application/vnd.kde.kpresenter":"*.kpt;*.kpr;","application/vnd.kde.kspread":"*.ksp;","application/vnd.kde.kword":"*.kwt;*.kwd;","application/vnd.kenameaapp":"*.htke;","application/vnd.kidspiration":"*.kia;","application/vnd.kinar":"*.kne;*.knp;","application/vnd.koan":"*.skd;*.skm;*.skt;*.skp;","application/vnd.kodak-descriptor":"*.sse;","application/vnd.las.las+xml":"*.lasxml;","application/vnd.llamagraphics.life-balance.desktop":"*.lbd;","application/vnd.llamagraphics.life-balance.exchange+xml":"*.lbe;","application/vnd.lotus-1-2-3":"*.123;","application/vnd.lotus-approach":"*.apr;","application/vnd.lotus-freelance":"*.pre;","application/vnd.lotus-notes":"*.nsf;","application/vnd.lotus-organizer":"*.org;","application/vnd.lotus-screencam":"*.scm;","application/vnd.lotus-wordpro":"*.lwp;","application/vnd.macports.portpkg":"*.portpkg;","application/vnd.mcd":"*.mcd;","application/vnd.medcalcdata":"*.mc1;","application/vnd.mediastation.cdkey":"*.cdkey;","application/vnd.mfer":"*.mwf;","application/vnd.mfmp":"*.mfm;","application/vnd.micrografx.flo":"*.flo;","application/vnd.micrografx.igx":"*.igx;","application/vnd.mif":"*.mif;","application/vnd.mobius.daf":"*.daf;","application/vnd.mobius.dis":"*.dis;","application/vnd.mobius.mbk":"*.mbk;","application/vnd.mobius.mqy":"*.mqy;","application/vnd.mobius.msl":"*.msl;","application/vnd.mobius.plc":"*.plc;","application/vnd.mobius.txf":"*.txf;","application/vnd.mophun.application":"*.mpn;","application/vnd.mophun.certificate":"*.mpc;","application/vnd.mozilla.xul+xml":"*.xul;","application/vnd.ms-artgalry":"*.cil;","application/vnd.ms-cab-compressed":"*.cab;","application/vnd.ms-excel":"*.xlm;*.xlb;*.xlt;*.xla;*.xlc;*.xls;*.xlw;","application/vnd.ms-excel.addin.macroenabled.12":"*.xlam;","application/vnd.ms-excel.sheet.binary.macroenabled.12":"*.xlsb;","application/vnd.ms-excel.sheet.macroenabled.12":"*.xlsm;","application/vnd.ms-excel.template.macroenabled.12":"*.xltm;","application/vnd.ms-fontobject":"*.eot;","application/vnd.ms-htmlhelp":"*.chm;","application/vnd.ms-ims":"*.ims;","application/vnd.ms-lrm":"*.lrm;","application/vnd.ms-officetheme":"*.thmx;","application/vnd.ms-pki.seccat":"*.cat;","application/vnd.ms-pki.stl":"*.stl;","application/vnd.ms-powerpoint":"*.pot;*.ppt;*.pps;*.ppa;*.pwz;","application/vnd.ms-powerpoint.addin.macroenabled.12":"*.ppam;","application/vnd.ms-powerpoint.presentation.macroenabled.12":"*.pptm;","application/vnd.ms-powerpoint.slide.macroenabled.12":"*.sldm;","application/vnd.ms-powerpoint.slideshow.macroenabled.12":"*.ppsm;","application/vnd.ms-powerpoint.template.macroenabled.12":"*.potm;","application/vnd.ms-project":"*.mpp;*.mpt;","application/vnd.ms-word.document.macroenabled.12":"*.docm;","application/vnd.ms-word.template.macroenabled.12":"*.dotm;","application/vnd.ms-works":"*.wcm;*.wps;*.wdb;*.wks;","application/vnd.ms-wpl":"*.wpl;","application/vnd.ms-xpsdocument":"*.xps;","application/vnd.mseq":"*.mseq;","application/vnd.musician":"*.mus;","application/vnd.muvee.style":"*.msty;","application/vnd.neurolanguage.nlu":"*.nlu;","application/vnd.noblenet-directory":"*.nnd;","application/vnd.noblenet-sealer":"*.nns;","application/vnd.noblenet-web":"*.nnw;","application/vnd.nokia.n-gage.data":"*.ngdat;","application/vnd.nokia.n-gage.symbian.install":"*.n-gage;","application/vnd.nokia.radio-preset":"*.rpst;","application/vnd.nokia.radio-presets":"*.rpss;","application/vnd.novadigm.edm":"*.edm;","application/vnd.novadigm.edx":"*.edx;","application/vnd.novadigm.ext":"*.ext;","application/vnd.oasis.opendocument.chart":"*.odc;","application/vnd.oasis.opendocument.chart-template":"*.otc;","application/vnd.oasis.opendocument.database":"*.odb;","application/vnd.oasis.opendocument.formula":"*.odf;","application/vnd.oasis.opendocument.formula-template":"*.odft;","application/vnd.oasis.opendocument.graphics":"*.odg;","application/vnd.oasis.opendocument.graphics-template":"*.otg;","application/vnd.oasis.opendocument.image":"*.odi;","application/vnd.oasis.opendocument.image-template":"*.oti;","application/vnd.oasis.opendocument.presentation":"*.odp;","application/vnd.oasis.opendocument.presentation-template":"*.otp;","application/vnd.oasis.opendocument.spreadsheet":"*.ods;","application/vnd.oasis.opendocument.spreadsheet-template":"*.ots;","application/vnd.oasis.opendocument.text":"*.odt;","application/vnd.oasis.opendocument.text-master":"*.odm;","application/vnd.oasis.opendocument.text-template":"*.ott;","application/vnd.oasis.opendocument.text-web":"*.oth;","application/vnd.olpc-sugar":"*.xo;","application/vnd.oma.dd2+xml":"*.dd2;","application/vnd.openofficeorg.extension":"*.oxt;","application/vnd.openxmlformats-officedocument.presentationml.presentation":"*.pptx;","application/vnd.openxmlformats-officedocument.presentationml.slide":"*.sldx;","application/vnd.openxmlformats-officedocument.presentationml.slideshow":"*.ppsx;","application/vnd.openxmlformats-officedocument.presentationml.template":"*.potx;","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"*.xlsx;","application/vnd.openxmlformats-officedocument.spreadsheetml.template":"*.xltx;","application/vnd.openxmlformats-officedocument.wordprocessingml.document":"*.docx;","application/vnd.openxmlformats-officedocument.wordprocessingml.template":"*.dotx;","application/vnd.osgeo.mapguide.package":"*.mgp;","application/vnd.osgi.dp":"*.dp;","application/vnd.palm":"*.pdb;*.oprc;*.pqa;","application/vnd.pawaafile":"*.paw;","application/vnd.pg.format":"*.str;","application/vnd.pg.osasli":"*.ei6;","application/vnd.picsel":"*.efif;","application/vnd.pmi.widget":"*.wg;","application/vnd.pdf":"*.pdf;","application/vnd.pocketlearn":"*.plf;","application/vnd.powerbuilder6":"*.pbd;","application/vnd.previewsystems.box":"*.box;","application/vnd.proteus.magazine":"*.mgz;","application/vnd.publishare-delta-tree":"*.qps;","application/vnd.pvi.ptid1":"*.ptid;","application/vnd.quark.quarkxpress":"*.qxd;*.qwd;*.qxt;*.qxb;*.qxl;*.qwt;","application/vnd.realvnc.bed":"*.bed;","application/vnd.recordare.musicxml":"*.mxl;","application/vnd.recordare.musicxml+xml":"*.musicxml;","application/vnd.rig.cryptonote":"*.cryptonote;","application/vnd.rim.cod":"*.cod;","application/vnd.rn-realmedia":"*.rm;","application/vnd.route66.link66+xml":"*.link66;","application/vnd.sailingtracker.track":"*.st;","application/vnd.seemail":"*.see;","application/vnd.sema":"*.sema;","application/vnd.semd":"*.semd;","application/vnd.semf":"*.semf;","application/vnd.shana.informed.formdata":"*.ifm;","application/vnd.shana.informed.formtemplate":"*.itp;","application/vnd.shana.informed.interchange":"*.iif;","application/vnd.shana.informed.package":"*.ipk;","application/vnd.simtech-mindmapper":"*.twd;*.twds;","application/vnd.smaf":"*.mmf;","application/vnd.smart.teacher":"*.teacher;","application/vnd.solent.sdkm+xml":"*.sdkd;*.sdkm;","application/vnd.spotfire.dxp":"*.dxp;","application/vnd.spotfire.sfs":"*.sfs;","application/vnd.stardivision.calc":"*.sdc;","application/vnd.stardivision.draw":"*.sda;","application/vnd.stardivision.impress":"*.sdd;","application/vnd.stardivision.math":"*.smf;","application/vnd.stardivision.writer":"*.vor;*.sdw;","application/vnd.stardivision.writer-global":"*.sgl;","application/vnd.stepmania.stepchart":"*.sm;","application/vnd.sun.xml.calc":"*.sxc;","application/vnd.sun.xml.calc.template":"*.stc;","application/vnd.sun.xml.draw":"*.sxd;","application/vnd.sun.xml.draw.template":"*.std;","application/vnd.sun.xml.impress":"*.sxi;","application/vnd.sun.xml.impress.template":"*.sti;","application/vnd.sun.xml.math":"*.sxm;","application/vnd.sun.xml.writer":"*.sxw;","application/vnd.sun.xml.writer.global":"*.sxg;","application/vnd.sun.xml.writer.template":"*.stw;","application/vnd.sus-calendar":"*.sus;*.susp;","application/vnd.svd":"*.svd;","application/vnd.symbian.install":"*.sisx;*.sis;","application/vnd.syncml+xml":"*.xsm;","application/vnd.syncml.dm+wbxml":"*.bdm;","application/vnd.syncml.dm+xml":"*.xdm;","application/vnd.tao.intent-module-archive":"*.tao;","application/vnd.tmobile-livetv":"*.tmo;","application/vnd.trid.tpt":"*.tpt;","application/vnd.triscape.mxs":"*.mxs;","application/vnd.trueapp":"*.tra;","application/vnd.ufdl":"*.ufd;*.ufdl;","application/vnd.uiq.theme":"*.utz;","application/vnd.umajin":"*.umj;","application/vnd.unity":"*.unityweb;","application/vnd.uoml+xml":"*.uoml;","application/vnd.vcx":"*.vcx;","application/vnd.visio":"*.vss;*.vsw;*.vsd;*.vst;","application/vnd.visionary":"*.vis;","application/vnd.vsf":"*.vsf;","application/vnd.wap.wbxml":"*.wbxml;","application/vnd.wap.wmlc":"*.wmlc;","application/vnd.wap.wmlscriptc":"*.wmlsc;","application/vnd.webturbo":"*.wtb;","application/vnd.wolfram.player":"*.nbp;","application/vnd.wordperfect":"*.wpd;","application/vnd.wqd":"*.wqd;","application/vnd.wt.stf":"*.stf;","application/vnd.xara":"*.xar;","application/vnd.xfdl":"*.xfdl;","application/vnd.yamaha.hv-dic":"*.hvd;","application/vnd.yamaha.hv-script":"*.hvs;","application/vnd.yamaha.hv-voice":"*.hvp;","application/vnd.yamaha.openscoreformat":"*.osf;","application/vnd.yamaha.openscoreformat.osfpvg+xml":"*.osfpvg;","application/vnd.yamaha.smaf-audio":"*.saf;","application/vnd.yamaha.smaf-phrase":"*.spf;","application/vnd.yellowriver-custom-menu":"*.cmp;","application/vnd.zul":"*.zirz;*.zir;","application/vnd.zzazz.deck+xml":"*.zaz;","application/voicexml+xml":"*.vxml;","application/widget":"*.wgt;","application/winhlp":"*.hlp;","application/wsdl+xml":"*.wsdl;","application/wspolicy+xml":"*.wspolicy;","application/x-7z-compressed":"*.7z;","application/x-abiword":"*.abw;","application/x-ace-compressed":"*.ace;","application/x-authorware-bin":"*.vox;*.aab;*.u32;*.x32;","application/x-authorware-map":"*.aam;","application/x-authorware-seg":"*.aas;","application/x-bcpio":"*.bcpio;","application/x-bittorrent":"*.torrent;","application/x-bzip":"*.bz;","application/x-bzip2":"*.boz;*.bz2;","application/x-cdlink":"*.vcd;","application/x-chat":"*.chat;","application/x-chess-pgn":"*.pgn;","application/x-cpio":"*.cpio;","application/x-csh":"*.csh;","application/x-debian-package":"*.deb;*.udeb;","application/x-director":"*.cst;*.fgd;*.dxr;*.swa;*.cct;*.cxt;*.dcr;*.dir;*.w3d;","application/x-doom":"*.wad;","application/x-dtbncx+xml":"*.ncx;","application/x-dtbook+xml":"*.dtb;","application/x-dtbresource+xml":"*.res;","application/x-dvi":"*.dvi;","application/x-font-bdf":"*.bdf;","application/x-font-ghostscript":"*.gsf;","application/x-font-linux-psf":"*.psf;","application/x-font-otf":"*.otf;","application/x-font-pcf":"*.pcf;","application/x-font-snf":"*.snf;","application/x-font-ttf":"*.ttf;*.ttc;","application/x-font-type1":"*.pfa;*.pfb;*.afm;*.pfm;","application/x-font-woff":"*.woff;","application/x-futuresplash":"*.spl;","application/x-gnumeric":"*.gnumeric;","application/x-gtar":"*.gtar;","application/x-hdf":"*.hdf;","application/x-impressionist":"*.imp;","application/x-java-jnlp-file":"*.jnlp;","application/x-latex":"*.latex;","application/x-mobipocket-ebook":"*.prc;*.mobi;","application/x-mpegurl":"*.m3u8;","application/x-ms-application":"*.application;","application/x-ms-wmd":"*.wmd;","application/x-ms-wmz":"*.wmz;","application/x-ms-xbap":"*.xbap;","application/x-msaccess":"*.mdb;","application/x-msbinder":"*.obd;","application/x-mscardfile":"*.crd;","application/x-msclip":"*.clp;","application/x-msdownload":"*.exe;*.bat;*.com;*.dll;*.msi;","application/x-msmediaview":"*.m13;*.m14;*.mvb;","application/x-msmetafile":"*.wmf;","application/x-msmoney":"*.mny;","application/x-mspublisher":"*.pub;","application/x-msschedule":"*.scd;","application/x-msterminal":"*.trm;","application/x-mswrite":"*.wri;","application/x-netcdf":"*.cdf;*.nc;","application/x-pdf":"*.pdf;","application/x-pkcs12":"*.p12;*.pfx;","application/x-pkcs7-certificates":"*.spc;*.p7b;","application/x-pkcs7-certreqresp":"*.p7r;","application/x-python-code":"*.pyc;*.pyo;","application/x-rar-compressed":"*.rar;","application/x-sh":"*.sh;","application/x-shar":"*.shar;","application/x-shockwave-flash":"*.swf;","application/x-silverlight-app":"*.xap;","application/x-stuffit":"*.sit;","application/x-stuffitx":"*.sitx;","application/x-sv4cpio":"*.sv4cpio;","application/x-sv4crc":"*.sv4crc;","application/x-tar":"*.tar;","application/x-tcl":"*.tcl;","application/x-tex":"*.tex;","application/x-tex-tfm":"*.tfm;","application/x-texinfo":"*.texinfo;*.texi;","application/x-ustar":"*.ustar;","application/x-wais-source":"*.src;","application/x-x509-ca-cert":"*.der;*.crt;","application/x-xfig":"*.fig;","application/x-xpinstall":"*.xpi;","application/xcap-diff+xml":"*.xdf;","application/xenc+xml":"*.xenc;","application/xhtml+xml":"*.xhtml;*.xht;","application/xml":"*.xml;*.xpdl;*.xsl;","application/xml-dtd":"*.dtd;","application/xop+xml":"*.xop;","application/xslt+xml":"*.xslt;","application/xspf+xml":"*.xspf;","application/xv+xml":"*.xhvml;*.mxml;*.xvm;*.xvml;","application/yang":"*.yang;","application/yin+xml":"*.yin;","application/zip":"*.zip;","audio/*":"*.dtshd;*.ecelp7470;*.aif;*.m2a;*.ram;*.lvp;*.wav;*.wax;*.ecelp9600;*.wma;*.mp4a;*.dra;*.rmi;*.rmp;*.midi;*.weba;*.m4a;*.m4p;*.mp3;*.ra;*.m3u;*.mpga;*.kar;*.aiff;*.aifc;*.mp2a;*.ogg;*.dts;*.oga;*.uva;*.eol;*.spx;*.pya;*.ecelp4800;*.uvva;*.rip;*.aac;*.adp;*.m3a;*.au;*.mid;*.mp2;*.snd;","audio/adpcm":"*.adp;","audio/basic":"*.au;*.snd;","audio/midi":"*.rmi;*.midi;*.kar;*.mid;","audio/mp4":"*.mp4a;","audio/mp4a-latm":"*.m4a;*.m4p;","audio/mpeg":"*.m2a;*.mp3;*.mpga;*.mp2a;*.m3a;*.mp2;","audio/ogg":"*.ogg;*.oga;*.spx;","audio/vnd.dece.audio":"*.uva;*.uvva;","audio/vnd.digital-winds":"*.eol;","audio/vnd.dra":"*.dra;","audio/vnd.dts":"*.dts;","audio/vnd.dts.hd":"*.dtshd;","audio/vnd.lucent.voice":"*.lvp;","audio/vnd.ms-playready.media.pya":"*.pya;","audio/vnd.nuera.ecelp4800":"*.ecelp4800;","audio/vnd.nuera.ecelp7470":"*.ecelp7470;","audio/vnd.nuera.ecelp9600":"*.ecelp9600;","audio/vnd.rip":"*.rip;","audio/webm":"*.weba;","audio/x-aac":"*.aac;","audio/x-aiff":"*.aif;*.aiff;*.aifc;","audio/x-mpegurl":"*.m3u;","audio/x-ms-wax":"*.wax;","audio/x-ms-wma":"*.wma;","audio/x-pn-realaudio":"*.ram;*.ra;","audio/x-pn-realaudio-plugin":"*.rmp;","audio/x-wav":"*.wav;","chemical/*":"*.csml;*.cmdf;*.cdx;*.xyz;*.cml;*.cif;","chemical/x-cdx":"*.cdx;","chemical/x-cif":"*.cif;","chemical/x-cmdf":"*.cmdf;","chemical/x-cml":"*.cml;","chemical/x-csml":"*.csml;","chemical/x-xyz":"*.xyz;","image/*":"*.ras;*.fh5;*.bmp;*.npx;*.djv;*.ief;*.xpm;*.fh;*.fhc;*.xbm;*.xif;*.png;*.pnm;*.pnt;*.dxf;*.ktx;*.dwg;*.uvg;*.jp2;*.pntg;*.ico;*.qtif;*.wbmp;*.sub;*.fbs;*.gif;*.tiff;*.webp;*.qti;*.psd;*.djvu;*.pbm;*.uvvi;*.ppm;*.cgm;*.fpx;*.rlc;*.svgz;*.rgb;*.pgm;*.svg;*.uvi;*.mac;*.xwd;*.g3;*.jpe;*.jpg;*.pcx;*.mdi;*.fh4;*.mmr;*.uvvg;*.fh7;*.fst;*.tif;*.pic;*.btif;*.pct;*.jpeg;*.cmx;*.pict;","image/bmp":"*.bmp;","image/cgm":"*.cgm;","image/g3fax":"*.g3;","image/gif":"*.gif;","image/ief":"*.ief;","image/jp2":"*.jp2;","image/jpeg":"*.jpe;*.jpg;*.jpeg;","image/ktx":"*.ktx;","image/pict":"*.pict;","image/png":"*.png;","image/prs.btif":"*.btif;","image/svg+xml":"*.svgz;*.svg;","image/tiff":"*.tiff;*.tif;","image/vnd.adobe.photoshop":"*.psd;","image/vnd.dece.graphic":"*.uvg;*.uvvi;*.uvi;*.uvvg;","image/vnd.djvu":"*.djv;*.djvu;","image/vnd.dvb.subtitle":"*.sub;","image/vnd.dwg":"*.dwg;","image/vnd.dxf":"*.dxf;","image/vnd.fastbidsheet":"*.fbs;","image/vnd.fpx":"*.fpx;","image/vnd.fst":"*.fst;","image/vnd.fujixerox.edmics-mmr":"*.mmr;","image/vnd.fujixerox.edmics-rlc":"*.rlc;","image/vnd.ms-modi":"*.mdi;","image/vnd.net-fpx":"*.npx;","image/vnd.wap.wbmp":"*.wbmp;","image/vnd.xiff":"*.xif;","image/webp":"*.webp;","image/x-cmu-raster":"*.ras;","image/x-cmx":"*.cmx;","image/x-freehand":"*.fh5;*.fh;*.fhc;*.fh4;*.fh7;","image/x-icon":"*.ico;","image/x-macpaint":"*.pnt;*.pntg;*.mac;","image/x-pcx":"*.pcx;","image/x-pict":"*.pic;*.pct;","image/x-portable-anymap":"*.pnm;","image/x-portable-bitmap":"*.pbm;","image/x-portable-graymap":"*.pgm;","image/x-portable-pixmap":"*.ppm;","image/x-quicktime":"*.qtif;*.qti;","image/x-rgb":"*.rgb;","image/x-xbitmap":"*.xbm;","image/x-xpixmap":"*.xpm;","image/x-xwindowdump":"*.xwd;","message/*":"*.eml;*.mhtml;*.mht;*.nws;*.mime;","message/rfc822":"*.eml;*.mhtml;*.mht;*.nws;*.mime;","model/*":"*.silo;*.wrl;*.dae;*.iges;*.dwf;*.mts;*.mesh;*.vrml;*.gdl;*.igs;*.msh;*.gtw;*.vtu;","model/iges":"*.iges;*.igs;","model/mesh":"*.silo;*.mesh;*.msh;","model/vnd.collada+xml":"*.dae;","model/vnd.dwf":"*.dwf;","model/vnd.gdl":"*.gdl;","model/vnd.gtw":"*.gtw;","model/vnd.mts":"*.mts;","model/vnd.vtu":"*.vtu;","model/vrml":"*.wrl;*.vrml;","text/*":"*.conf;*.jad;*.csv;*.css;*.pl;*.py;*.htm;*.tsv;*.hbs;*.dsc;*.ms;*.sgml;*.txt;*.tr;*.uu;*.etx;*.asm;*.dcurl;*.ifb;*.wml;*.mcurl;*.def;*.rtx;*.in;*.pas;*.hh;*.vcf;*.manifest;*.text;*.gv;*.for;*.ttl;*.ksh;*.ics;*.uri;*.list;*.cc;*.log;*.cxx;*.vcs;*.flx;*.fly;*.f90;*.me;*.roff;*.scurl;*.man;*.3dml;*.wmls;*.urls;*.html;*.sgm;*.n3;*.f77;*.spot;*.uris;*.h;*.c;*.f;*.p;*.s;*.t;*.cpp;*.dic;*.curl;*.java;","text/cache-manifest":"*.manifest;","text/calendar":"*.ifb;*.ics;","text/css":"*.css;","text/csv":"*.csv;","text/html":"*.htm;*.hbs;*.html;","text/n3":"*.n3;","text/pdf":"*.pdf;","text/plain":"*.conf;*.pl;*.txt;*.def;*.in;*.text;*.ksh;*.list;*.log;","text/prs.lines.tag":"*.dsc;","text/richtext":"*.rtx;","text/sgml":"*.sgml;*.sgm;","text/tab-separated-values":"*.tsv;","text/troff":"*.ms;*.tr;*.me;*.roff;*.man;*.t;","text/turtle":"*.ttl;","text/uri-list":"*.uri;*.urls;*.uris;","text/vnd.curl":"*.curl;","text/vnd.curl.dcurl":"*.dcurl;","text/vnd.curl.mcurl":"*.mcurl;","text/vnd.curl.scurl":"*.scurl;","text/vnd.fly":"*.fly;","text/vnd.fmi.flexstor":"*.flx;","text/vnd.graphviz":"*.gv;","text/vnd.in3d.3dml":"*.3dml;","text/vnd.in3d.spot":"*.spot;","text/vnd.sun.j2me.app-descriptor":"*.jad;","text/vnd.wap.wml":"*.wml;","text/vnd.wap.wmlscript":"*.wmls;","text/x-asm":"*.asm;*.s;","text/x-c":"*.hh;*.cc;*.cxx;*.h;*.c;*.cpp;*.dic;","text/x-fortran":"*.for;*.f90;*.f77;*.f;","text/x-java-source":"*.java;","text/x-pascal":"*.pas;*.p;","text/x-pdf":"*.pdf;","text/x-python":"*.py;","text/x-setext":"*.etx;","text/x-uuencode":"*.uu;","text/x-vcalendar":"*.vcs;","text/x-vcard":"*.vcf;","video/*":"*.f4v;*.asf;*.uvp;*.uvs;*.jpgm;*.viv;*.mpeg;*.m4v;*.m2v;*.ts;*.3gp;*.jpgv;*.ogv;*.movie;*.wvx;*.m1v;*.avi;*.wmx;*.uvv;*.mov;*.3g2;*.qt;*.mpa;*.mpg;*.mpe;*.pyv;*.webm;*.mp4;*.h263;*.h261;*.h264;*.fvt;*.mp4v;*.mpg4;*.flv;*.uvvh;*.uvvp;*.uvvu;*.uvvv;*.mxu;*.fli;*.asx;*.uvm;*.uvh;*.uvu;*.uvvm;*.jpm;*.mj2;*.wmv;*.wm;*.dv;*.uvvs;*.m4u;*.dif;*.mjp2;","video/3gpp":"*.3gp;","video/3gpp2":"*.3g2;","video/h261":"*.h261;","video/h263":"*.h263;","video/h264":"*.h264;","video/jpeg":"*.jpgv;","video/jpm":"*.jpgm;*.jpm;","video/mj2":"*.mj2;*.mjp2;","video/mp2t":"*.ts;","video/mp4":"*.mp4;*.mp4v;*.mpg4;","video/mpeg":"*.mpeg;*.m2v;*.m1v;*.mpa;*.mpg;*.mpe;","video/ogg":"*.ogv;","video/quicktime":"*.mov;*.qt;","video/vnd.dece.hd":"*.uvvh;*.uvh;","video/vnd.dece.mobile":"*.uvm;*.uvvm;","video/vnd.dece.pd":"*.uvp;*.uvvp;","video/vnd.dece.sd":"*.uvs;*.uvvs;","video/vnd.dece.video":"*.uvv;*.uvvv;","video/vnd.fvt":"*.fvt;","video/vnd.mpegurl":"*.mxu;*.m4u;","video/vnd.ms-playready.media.pyv":"*.pyv;","video/vnd.uvvu.mp4":"*.uvvu;*.uvu;","video/vnd.vivo":"*.viv;","video/webm":"*.webm;","video/x-dv":"*.dv;*.dif;","video/x-f4v":"*.f4v;","video/x-fli":"*.fli;","video/x-flv":"*.flv;","video/x-m4v":"*.m4v;","video/x-ms-asf":"*.asf;*.asx;","video/x-ms-wm":"*.wm;","video/x-ms-wmv":"*.wmv;","video/x-ms-wmx":"*.wmx;","video/x-ms-wvx":"*.wvx;","video/x-msvideo":"*.avi;","video/x-sgi-movie":"*.movie;","x-conference/*":"*.ice;","x-conference/x-cooltalk":"*.ice;"}}),define("mimetypes",["lodash","./util","./extension_mimetype_map","./mimetype_extension_map"],function(e,t,n,r){var i="application/octet-stream",s=["application/octet-stream","application/download","application/force-download","octet/stream","application/unknown","application/x-download","application/x-msdownload","application/x-secure-download"],o=function(t){return!e.contains(s,t)},u=function(e){var t=r[e];return t?t.split(";"):[]},a=function(e){var t=u(e);return t.length>0?t[0].split(";")[0]:""},f=function(e){return e[0]!="."&&(e="."+e),e=e.toLowerCase(),n[e]||"application/octet-stream"},l=function(n,r){n||(n=i);if(e.isArray(r))return e.any(r,function(e){return l(n,e)});n=t.trim(n).toLowerCase(),r=t.trim(r).toLowerCase();if(!o(n))return!0;var s=n.split("/"),u=r.split("/");return u[0]=="*"?!0:u[0]!=s[0]?!1:u[1]=="*"?!0:u[1]==s[1]};return{guessAllExtensions:u,guessExtension:a,guessType:f,match:l,defaultType:i,isValidMimetype:o}}),define("iframeuploader",["./server","./mimetypes","json","jquery"],function(e,t,n,r){var i=function(e,t,n,r,s){return this instanceof i?(this.form=e,this.fileinput=t,this.iframe=n,this.js_session_input=r,this.retry=s!==!1,this.retries={},this.max_retries=3,this.beforeAll=function(){},this.onStart=function(){},this.onSuccessHandler=function(){},this.onErrorHandler=function(){},this.onProgress=function(){},this.afterAllHandler=function(){},this.checkValidHandler=function(){return!0},this.count=0,this.left=0,this.initialize(),this):new i(e,t,n,r,s)},s=function(e){var n={};n.name=e.replace("C:\\fakepath\\","");var r=n.name.split(".");return r.length==2?n.type=t.guessType(r[1]):n.type=t.defaultType,n};i.prototype.initialize=function(){var t=this,n=r(this.form);if(!this.js_session_input||!n.length)return!1;if(!this.iframe.id||!this.iframe.name){var i=this.iframe.parentNode;i.removeChild(this.iframe),this.iframe.id||(this.iframe.id="iframe_uploader_"+(new Date).getTime()),this.iframe.name=this.iframe.id,i.appendChild(this.iframe)}return this.js_session_input.value=e.getJsSession(!0),n.attr("target",this.iframe.name),n.attr("method","POST"),n.attr("action",e.urls.upload),n.attr("enctype","multipart/form-data"),this.fileinput.onchange=function(){if(!this.value)return!1;var e=s(this.value);return t.checkValid([e])?(n.submit(),!0):!1},n.submit(function(){var n=s(t.fileinput.value);if(t.retries[0])return!0;if(!t.checkValid(n))return!1;t.beforeAll();if(t.onStart(n,0)===!1)return!1;t.count++,t.left++,e.setUploading(!0);var i=r(t.iframe);return i.off("load.fp").on("load.fp",function(){t.onUploadFinish(n)}),r(t.fileinput).removeAttr("disabled"),window.setTimeout(function(){r(t.fileinput).attr("disabled","disabled")},50),!0}),!0},i.prototype.onUploadFinish=function(t){var i=this.iframe.contentDocument?this.iframe.contentDocument:window.frames[this.iframe.id].document,s=n.parse(r("body",i).text()),o=e.massageResponse(s);o.error?this.onError(t,0,o.error):this.onSuccess(t,0,o.payload)},i.prototype.uploadFiles=function(e){throw new Exception("IFrame uploader cannot upload DOM file objects")},i.prototype.upload=function(e,t){throw new Exception("IFrame uploader cannot upload DOM file objects")},i.prototype.onSuccess=function(e,t,n){this.left--,n=n[0],this.onProgress(e,t,100),this.onSuccessHandler(e,t,n),this.left<=0&&this.afterAll()},i.prototype.onError=function(e,t,n){if(this.retry&&n&&!n.noretry){this.retries[t]||(this.retries[t]=0),this.retries[t]++;if(this.retries[t]<=this.max_retries){var i=(this.retries[t]*100/(this.max_retries+1)).toFixed(2);i=parseInt(i,10),this.onProgress(e,t,i),r(this.form).submit();return}}this.left--,this.hadError=!0,this.onProgress(e,t,100);var s=n.msg||n;this.onErrorHandler(e,t,"server_error",s),this.left===0&&(this.afterAll(),this.hadError=!1)},i.prototype.afterAll=function(){e.setUploading(!1),this.retries={},this.count=0,this.afterAllHandler(!this.hadError)},i.prototype.setBeforeAllListener=function(e){this.beforeAll=e},i.prototype.setOnStartListener=function(e){this.onStart=e},i.prototype.setOnSuccessListener=function(e){this.onSuccessHandler=e},i.prototype.setOnErrorListener=function(e){this.onErrorHandler=e},i.prototype.setOnProgressListener=function(e){this.onProgress=e},i.prototype.setAfterAllListener=function(e){this.afterAllHandler=e},i.prototype.checkValid=function(){return this.checkValidHandler.apply(this,arguments)},i.prototype.setValidChecker=function(e){this.checkValidHandler=e},i.prototype.destroy=function(){this.fileinput.onchange=function(){};var e=r(this.form);e.off("submit")};var o=!0,u=function(e){o=e},a=function(){return o};return{IFrameUploader:i,isEnabled:a,setEnabled:u}}),define("flashdetect",[],function(){var e={};e.installed=!1,e.raw="",e.major=-1,e.minor=-1,e.revision=-1,e.revisionStr="";var t=[{name:"ShockwaveFlash.ShockwaveFlash.7",version:function(e){return n(e)}},{name:"ShockwaveFlash.ShockwaveFlash.6",version:function(e){var t="6,0,21";try{e.AllowScriptAccess="always",t=n(e)}catch(r){}return t}},{name:"ShockwaveFlash.ShockwaveFlash",version:function(e){return n(e)}}],n=function(e){var t=-1;try{t=e.GetVariable("$version")}catch(n){}return t},r=function(e){var t=-1;try{t=new ActiveXObject(e)}catch(n){t={activeXError:!0}}return t},s=function(e){var t=e.split(",");return{raw:e,major:parseInt(t[0].split(" ")[1],10),minor:parseInt(t[1],10),revision:parseInt(t[2],10),revisionStr:t[2]}},o=function(e){var t=e.split(/ +/),n=t[2].split(/\./),r=t[3];return{raw:e,major:parseInt(n[0],10),minor:parseInt(n[1],10),revisionStr:r,revision:u(r)}},u=function(t){return parseInt(t.replace(/[a-zA-Z]/g,""),10)||e.revision};return e.majorAtLeast=function(t){return e.major>=t},e.minorAtLeast=function(t){return e.minor>=t},e.revisionAtLeast=function(t){return e.revision>=t},e.versionAtLeast=function(t){var n=[e.major,e.minor,e.revision],r=Math.min(n.length,arguments.length);for(i=0;i<r;i++){if(n[i]>=arguments[i]){if(i+1<r&&n[i]==arguments[i])continue;return!0}return!1}return!1},e.FlashDetect=function(){var n,i;if(navigator.plugins&&navigator.plugins.length>0){var u="application/x-shockwave-flash",a=navigator.mimeTypes;a&&a[u]&&a[u].enabledPlugin&&a[u].enabledPlugin.description&&(n=a[u].enabledPlugin.description,i=o(n),e.raw=i.raw,e.major=i.major,e.minor=i.minor,e.revisionStr=i.revisionStr,e.revision=i.revision,e.installed=!0)}else if(navigator.appVersion.indexOf("Mac")==-1&&window.execScript){n=-1;for(var f=0;f<t.length&&n==-1;f++){var l=r(t[f].name);l.activeXError||(e.installed=!0,n=t[f].version(l),n!=-1&&(i=s(n),e.raw=i.raw,e.major=i.major,e.minor=i.minor,e.revision=i.revision,e.revisionStr=i.revisionStr))}}}(),{FlashDetect:e}}),define("flashuploader",["./server","./mimetypes","json","./prettyprint","./util","./window","flashdetect","swfupload","lodash"],function(e,t,n,r,i,s,o,u,a){var f={flash_url:"/static/res/swfupload/Flash/swfupload.swf",uploader_id:"#SWFUpload_0"},l,c=function(e,t,n,r,i,s){return l?(l.restore(e),l):this instanceof c?(this.fileinput=e,this.acceptMultiple=!!t,this.mimetypes=n,this.extensions=r,this.maxSize=i||0,this.maxFiles=s||0,this.beforeAll=function(){},this.onStart=function(){},this.onSuccessHandler=function(){},this.onErrorHandler=function(){},this.onProgress=function(){},this.afterAllHandler=function(){},this.checkValid=function(){return!0},this.count=0,this.left=0,this.hadError=!1,this.initialize(),l=this,this):new c(e,t,n,r,i,s)};c.prototype.initialize=function(){if(!this.fileinput)return!1;var n=this.acceptMultiple?this.maxFiles?this.maxFiles:0:1,i=this.maxSize?parseInt(this.maxSize,10)/1048576:0,s=i.toString();i&&(s+=" MB");var o,l;if(this.extensions)o=a.map(this.extensions,function(e){return"*"+e}).join(";"),l=r.print_mimetypes(a.map(this.extensions,function(e){return t.guessType(e)}));else if(this.mimetypes){var c=a.chain(this.mimetypes).map(function(e){return t.guessAllExtensions(e)}).flatten().compact().value();o=c.join(";"),l=r.print_mimetypes(this.mimetypes)}else o="*.*",l="All files";var h=this.acceptMultiple?u.BUTTON_ACTION.SELECT_FILES:u.BUTTON_ACTION.SELECT_FILE;return this.swfu=new u({upload_url:e.urls.upload,debug:!1,file_post_name:"fileUpload",post_params:{js_session:e.getJsSession(!0)},use_query_string:!1,requeue_on_error:!1,http_success:[201,202],assume_success_timeout:0,file_types:o,file_types_description:l,file_size_limit:s,file_upload_limit:n,file_queue_limit:n,file_queue_error_handler:a.bind(this.fileQueueError,this),file_dialog_complete_handler:a.bind(this.fileDialogComplete,this),upload_start_handler:a.bind(this.uploadStart,this),upload_progress_handler:a.bind(this.uploadProgress,this),upload_error_handler:a.bind(this.uploadError,this),upload_success_handler:a.bind(this.uploadSuccess,this),upload_complete_handler:a.bind(this.uploadComplete,this),flash_url:f.flash_url,button_width:100,button_height:30,button_text:"",button_action:h,button_cursor:u.CURSOR.HAND,button_window_mode:u.WINDOW_MODE.TRANSPARENT,button_placeholder_id:this.fileinput.id}),!0},c.prototype.fileQueueError=function(e,t,n){try{switch(t){case u.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:this.onError(e,0,"too_many");break;case u.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:this.onError(e,0,"too_big");break;case u.QUEUE_ERROR.ZERO_BYTE_FILE:this.onError(e,0,"empty");break;case u.QUEUE_ERROR.INVALID_FILETYPE:this.extensions?this.onError(e,0,"invalid_extension"):this.onError(e,0,"invalid_type");break;default:this.onError(e,0,"error")}}catch(r){i.console.log(r)}};var h=function(e){return{id:e.id,name:e.name,type:t.guessType(e.type),size:e.size,creationDate:e.creationdate}};c.prototype.fileDialogComplete=function(t,n){try{if(t>0){var r=[],s=this.swfu.getStats(),o=s.queue_errors+s.upload_cancelled+s.upload_errors;for(var u=o;u<o+n;u++){var a=this.swfu.getFile(u);a=h(a),r.push(a)}if(this.checkValid(r)){this.beforeAll();for(u=0;u<r.length;u++)a=r[u],this.onStart(a,a.id)===!1&&this.swfu.cancelUpload(a.id,!0);e.setUploading(!0),this.swfu.startUpload()}else for(u=0;u<r.length;u++)this.swfu.cancelUpload(r[u].id,!0)}}catch(f){i.console.log(f)}},c.prototype.uploadStart=function(e){return!0},c.prototype.uploadProgress=function(e,t){try{var n=t/e.size*100;n=n.toFixed(2),this.onProgress(e,e.id,n)}catch(r){i.console.log(r)}},c.prototype.uploadSuccess=function(t,r){try{var s=e.massageResponse(n.parse(r));s.error?this.onError(t,t.id,s.error):this.onSuccess(t,t.id,s.payload)}catch(o){i.console.log(o)}},c.prototype.uploadError=function(e,t,n){try{this.onError(e,e.id,n)}catch(r){i.console.log(r)}},c.prototype.uploadComplete=function(e){try{this.swfu.getStats().files_queued>0?this.swfu.startUpload():this.afterAll()}catch(t){i.console.log(t)}},c.prototype.onSuccess=function(e,t,n){n=n[0],this.onSuccessHandler(e,t,n)},c.prototype.onError=function(e,t,n){var r={too_many:"Too many files",too_big:"File too large",empty:"Empty file",invalid_type:"Invalid file type",invalid_extension:"Invalid file type"};r[n]?this.onErrorHandler(e,t,n,r[n]):n.msg?(this.hadError=!0,this.onErrorHandler(e,t,"server_error",n.msg)):(this.hadError=!0,this.onErrorHandler(e,t,n))},c.prototype.afterAll=function(){e.setUploading(!1),this.count=0,this.afterAllHandler(!this.hadError),this.hadError=!1},c.prototype.setBeforeAllListener=function(e){this.beforeAll=e},c.prototype.setOnStartListener=function(e){this.onStart=e},c.prototype.setOnSuccessListener=function(e){this.onSuccessHandler=e},c.prototype.setOnErrorListener=function(e){this.onErrorHandler=e},c.prototype.setOnProgressListener=function(e){this.onProgress=e},c.prototype.setAfterAllListener=function(e){this.afterAllHandler=e},c.prototype.setValidChecker=function(e){this.checkValid=e},c.prototype.dispose=function(){if(!this.swfu)return;this.swfu.destroy();if(this.swfu.movieElement){var e=this.swfu.movieElement.parentNode;e.removeChild(this.swfu.movieElement),this.fileinput&&e.appendChild(this.fileinput)}this.swfu=undefined},c.prototype.unload=function(){try{var e=$(f.uploader_id).parent();e.hide(),e.appendTo($("body"))}catch(t){}},c.prototype.restore=function(e){var t=$(f.uploader_id).parent();t.length&&($("#fileInputContainer").replaceWith(t),t.show(),t.attr("id","fileInputContainer"))};var p=function(){l&&l.dispose(),l=undefined};s.addOnDestroy(function(){p()});var d=function(){return l},v=!0,m=function(){return!v||typeof u=="undefined"?!1:o.FlashDetect.versionAtLeast(9)},g=function(e){v=e};return{FlashUploader:c,getInstance:d,dispose:p,isEnabled:m,setEnabled:g}}),define("dragdrop",["jquery","./util"],function(e,t){var n=function(t){return this instanceof n?(this.pane=e(t),this.onDropFolderHandler=function(){},this.onDropFileHandler=function(){},this.onDropUrlHandler=function(){},this.onDropErrorHandler=function(){},this.onDragEnterHandler=function(){},this.onDragLeaveHandler=function(){},this.enabled=!0,this):new n(t)};n.prototype.initialize=function(){this.pane.on("drop",this.dropHandler()),this.pane.on("dragenter",this.dragEnterHandler()),this.pane.on("dragover",this.dragOverHandler()),this.pane.on("dragleave",this.dragLeaveHandler())},n.prototype.disable=function(){this.enabled=!1},n.prototype.enable=function(){this.enabled=!0},n.prototype.isEnabled=function(){return this.enabled},n.prototype.dropHandler=function(){var t=this;return function(n){if(!t.enabled)return t.onDropErrorHandler("disabled"),n.preventDefault(),!1;if(!n||!n.originalEvent)return t.onDropErrorHandler("invalid_drop"),n.preventDefault(),!1;var r=n.originalEvent;if(!r.dataTransfer)return t.onDropErrorHandler("invalid_drop"),n.preventDefault(),!1;if(r.dataTransfer.files&&r.dataTransfer.files.length>0){var i=[],s=[];if(r.dataTransfer.items){i=[];var o=r.dataTransfer.items;for(var u=0;u<o.length;u++){var a=o[u]&&o[u].webkitGetAsEntry?o[u].webkitGetAsEntry():undefined,f=r.dataTransfer.files[u];a&&!!a.isDirectory?s.push(f):f&&i.push(f)}}else i=r.dataTransfer.files;i&&i.length>0&&setTimeout(function(){t.onDropFileHandler(i)},1),s&&s.length>0&&setTimeout(function(){t.onDropFolderHandler(s)},1)}else{var l=e(r.dataTransfer.getData("text/html")).filter("img").attr("src");l?setTimeout(function(){t.onDropUrlHandler(l)},1):t.onDropErrorHandler("invalid_drop")}return n.preventDefault(),!1}},n.prototype.dragEnterHandler=function(){var t=this;return t.drag_set=e(),function(e){return t.drag_set.size()===0&&t.onDragEnterHandler(),e.preventDefault(),t.drag_set=t.drag_set.add(e.target),!1}},n.prototype.dragOverHandler=function(){var t=this;return function(t){return e.browser.chrome||t.preventDefault(),t&&t.originalEvent&&t.originalEvent.dataTransfer&&(t.originalEvent.dataTransfer.dropEffect="copy"),!1}},n.prototype.dragLeaveHandler=function(){var e=this;return function(t){setTimeout(function(){e.drag_set=e.drag_set.not(t.target),e.drag_set.size()===0&&e.onDragLeaveHandler()},1)}},n.prototype.setOnDropFolders=function(e){this.onDropFolderHandler=e},n.prototype.setOnDropFiles=function(e){this.onDropFileHandler=e},n.prototype.setOnDropUrl=function(e){this.onDropUrlHandler=e},n.prototype.setOnDragEnter=function(e){this.onDragEnterHandler=e},n.prototype.setOnDragLeave=function(e){this.onDragLeaveHandler=e},n.prototype.setOnDropError=function(e){this.onDropErrorHandler=e};var r=!0,i=function(){return r=r&&(!!window.FileReader||e.browser.safari)&&"draggable"in document.createElement("span"),r=r&&!t.isMobile(),r},s=function(e){r=e};return{DragDrop:n,isEnabled:i,setEnabled:s}}),define("computeruploadview",["./templates","./view","./html5uploader","./iframeuploader","./flashuploader","./dragdrop","./prettyprint","./mimetypes","./util","./server","./comm","./notify","lodash","jquery"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){var d={};d.fileinput="#fileUploadInput",d.uploadbutton="#fileUploadDummy",d.extrauploadbutton="#extra-upload-button",d.uploadform="#fileUploadForm",d.backupcontainer="#fileInputContainerBackup",d.uploadiframe="#fileuploadtarget",d.dragFrame="#localDragDrop",d.messageText="#localDragHelp",d.acceptFileHighlight="acceptFileDrop",d.jsSessionInput="#fileUploadSession";var v=function(e,t,n,r,i){return this instanceof v?(this.multiple=!!e,this.mimetypes=t,this.extensions=n,this.maxSize=r||0,this.maxFiles=i||0,this.uploader,this.dragdrop,this.progressMap={},this.responses=[],this):new v(e,t,n,r,i)};return v.prototype.render=function(){t.setContents(e.render("computer",{multiple:this.multiple,mimetypes:this.mimetypes?this.mimetypes.join(","):"*/*"})),t.setActiveClient("computer"),t.setView(this),p(d.extrauploadbutton).css("visibility","hidden"),this.message_box=p(d.messageText),this.progress_pane=p(d.dragFrame),this.setupUploader(),this.setupDragDrop()},v.prototype.setMessage=function(e){this.message_box.show().text(e)},v.prototype.hideMessage=function(){this.message_box&&this.message_box.hide()},v.prototype.setupUploader=function(){this.uploader=this.getUploader(),this.uploader.setBeforeAllListener(h.bind(this.beforeAll,this)),this.uploader.setOnStartListener(h.bind(this.onStart,this)),this.uploader.setOnProgressListener(h.bind(this.onProgress,this)),this.uploader.setOnErrorListener(h.bind(this.onError,this)),this.uploader.setOnSuccessListener(h.bind(this.onSuccess,this)),this.uploader.setAfterAllListener(h.bind(this.afterAll,this)),this.uploader.setValidChecker(h.bind(this.checkValid,this))},v.prototype.unload=function(){this.uploader.unload&&this.uploader.unload(),p(d.extrauploadbutton).css("visibility","visible")},v.prototype.dispose=function(){this.uploader.dispose&&this.uploader.dispose()},v.prototype.beforeAll=function(){this.progress_pane.empty(),p(d.uploadbutton).text("Uploading").attr("disabled","disabled"),p(d.fileinput).attr("disabled","disabled"),this.dragdrop&&this.dragdrop.disable(),this.setMessage("Starting upload")},v.prototype.onStart=function(e,n){this.hideMessage();var r=this.createUploadProgressWidget(e,n);this.progressMap[n]=r,this.progress_pane&&this.progress_pane.append(r),t.disableClients(),t.getClientLink("computer").removeClass("disabled")},v.prototype.onProgress=function(e,t,n){var r=this.progressMap[t];if(!r)return;n=(.95*n).toFixed(2),r.find(".bar").text(n+"%").css("width",Math.max(n,10)+"%")},v.prototype.onSuccess=function(e,t,n){var r=this.progressMap[t];r&&r.removeClass("active").find(".bar").text("Upload Complete").css("width","100%"),this.responses.push(n)},v.prototype.onError=function(e,t,n,r){n=="server_error"?r?c.error(r):e.name?c.error("We had trouble uploading "+e.name+", please try again"):c.error("We had trouble uploading one of your files, please try again"):n=="too_many"?this.multiple?c.error("This site only allows you to upload "+this.maxFiles+" files at a time"):c.error("This site only allows you to upload one file at a time"):n=="too_big"?c.error("This site only allows you to upload files under "+o.print_size(this.maxSize)):n=="empty"?c.error("Oops, looks like the file you uploaded was empty"):n=="invalid_type"?c.error("Oops! Doesn't look like you can upload that. The page specifically asked for a "+o.print_mimetype(this.mimetypes)+" but '"+e.name+"' doesn't fit the bill. Try a different file."):n=="invalid_extension"&&c.error("Oops! Doesn't look like you can upload that. The page specifically asked for a file with an extension of "+this.extensions.join(" or ")+" but '"+e.name+"' doesn't fit the bill. Try a different file.");var i=this.progressMap[t];i&&i.addClass("progress-danger").find(".bar").text("Error").width("100%")},v.prototype.afterAll=function(e){var n=p(d.uploadbutton).removeClass("disabled").removeAttr("disabled");this.dragdrop&&this.dragdrop.enable(),p(d.fileinput).removeAttr("disabled"),t.enableClients(),e?(n.text("Uploaded!"),l.sendAllResponses(this.responses)):n.text("Try Again")},v.prototype.checkValid=function(e){if(e.length===0)return!1;if(!this.multiple&&e.length>1)return this.onError(e[0],0,"too_many"),!1;if(this.maxFiles&&e.length>this.maxFiles)return this.onError(e[0],0,"too_many"),!1;var t;for(var n=0;n<e.length;n++){t=e[n];var r=t.name?t.name.toLowerCase():"";if(this.extensions){var i=h.map(this.extensions,function(e){return r.indexOf(e.toLowerCase(),r.length-e.length)!==-1});if(!h.any(i))return this.onError(t,n,"invalid_extension"),!1}else if(this.mimetypes){var s=u.isValidMimetype(t.type);if(s&&!u.match(t.type,this.mimetypes))return this.onError(t,n,"invalid_type"),!1;if(!s)return!0}if(this.maxSize&&t.size&&t.size>this.maxSize)return this.onError(t,n,"too_big"),!1}return!0},v.prototype.createUploadProgressWidget=function(t,n){var r=u.match(t.type,"image/*")&&(!!window.FileReader&&t.size>0||!!t.url),i=o.print_size(t.size);r=r&&(t.size||0)<5242880,r=r&&(this.uploader.count||0)<20;var s=p(e.render("computer_progress",{name:t.name,thumb_exists:r,size:i,fileid:n,modified:t.lastModifiedDate?t.lastModifiedDate.toLocaleDateString():""}));s.find(".bar").text("Starting").css("width","13%");if(r)if(!t.url){var a=new FileReader;a.onload=function(e){s.find(".thumbnail-spinner").hide(),s.find(".thumbnail-image").attr("src",e.target.result).show()},a.readAsDataURL(t)}else s.find(".thumbnail-spinner").hide(),s.find(".thumbnail-image").attr("src",t.url).show();return s},v.prototype.getUploader=function(){var e=p(d.uploadform)[0],t=p(d.fileinput)[0],s=p(d.uploadiframe)[0],o=p(d.jsSessionInput)[0];return n.isEnabled()?new n.HTML5Uploader(e,t):i.isEnabled()?new i.FlashUploader(t,this.multiple,this.mimetypes,this.extensions,this.maxSize,this.maxFiles):new r.IFrameUploader(e,t,s,o)},v.prototype.setupDragDrop=function(){if(s.isEnabled()){var e=p(d.dragFrame);this.dragdrop=new s.DragDrop(e);var t=this;this.dragdrop.setOnDragEnter(function(){e.addClass(d.acceptFileHighlight),t.setMessage("Drop to Upload")}),this.dragdrop.setOnDragLeave(function(){e.removeClass(d.acceptFileHighlight),t.setMessage("Drag files here")}),this.dragdrop.setOnDropError(function(e){e=="invalid_drop"&&t.setMessage("Doesn't seem like that was a valid file, please try again")}),this.dragdrop.setOnDropFolders(h.bind(this.onFolderDrop,this)),this.dragdrop.setOnDropFiles(h.bind(this.onFileDrop,this)),this.dragdrop.setOnDropUrl(h.bind(this.onUrlDrop,this)),this.dragdrop.initialize()}else a.isMobile()?p(d.messageText).text("Upload from your device"):p(d.messageText).text("Upload from your computer"),p(d.uploadform).find(".control-label").text("Select a file:"),p(d.dragFrame).css("background","none"),p(d.dragFrame).css("border","solid 1px black"),this.dragdrop=undefined},v.prototype.onFileDrop=function(e){var t=p(d.dragFrame);t.removeClass(d.acceptFileHighlight),this.uploader.uploadFiles(e)},v.prototype.onFolderDrop=function(e){var t=p(d.dragFrame);t.removeClass(d.acceptFileHighlight),c.error("Oops, we can't upload entire folders - please select individual files to upload.")},v.prototype.onUrlDrop=function(e){var t=a.parseFilename(e),n=t.match(/\.\w*$/)[0],r={};r.name=t,r.type=u.guessType(n),r.url=e,r.size=0;if(!this.checkValid([r]))return;f.setUploading(!0),this.onStart(r,0);var i=this.progressMap[0].find(".bar");i.text("20%").width("20%"),setTimeout(function(){var e=60;e>i.width()/i.parent().width()*100&&i.text(e+"%").width(e+"%")},1e3);var s=this;f.uploadUrl(e,t,function(e){f.setUploading(!1);if(s.checkValid([e])){var t=e,n=e.url;delete e.url,s.onSuccess(r,0,{url:n,data:t}),s.afterAll(!0)}},function(e){f.setUploading(!1),s.onError(r,0,"server_error",e),s.afterAll(!1)})},{ComputerUploadView:v}}),define("computersaveview",["./templates","./view","./servervars","./window","jquery"],function(e,t,n,r,i){var s=function(e){return this instanceof s?(this.url=e,this):new s(e)};return s.prototype.render=function(){t.setContents(e.render("computer_saveas",{download_url:this.url,in_window:!n.iframe})),i("#closebutton").click(function(){r.close()}),t.setActiveClient("computer"),t.setView(this)},{ComputerSaveView:s}}),define("computer",["./navigation","./servervars","./server","./computeruploadview","./computersaveview","jquery"],function(e,t,n,r,i,s){var o={};o.url="#/computer/",o.selector='.client[data-client="computer"]>a';var u,a=function(){s(document).bind("dragenter",function(){window.location.hash=o.url}),u=r.ComputerUploadView(t.multiple,t.mimetypes,t.extensions,t.maxSize,t.maxFiles)},f=function(){var e=n.getEchoUrl();t.dialogType=="saveas"&&s(o.selector).attr("href",e).click(function(){c()}),u=i.ComputerSaveView(e)},l=function(){e.register(o.url,c),t.dialogType=="open"?a():t.dialogType=="saveas"&&f()},c=function(){u.render()},h=function(){return u};return{initialize:l,render:c,getView:h}}),define("pathobject",["./util","./server","./servervars"],function(e,t,n){var r={},i=function(e){return r[e]},s=function(e){delete r[e]},o=function(e){return this instanceof o?(this.save_disabled=!!e.save_disabled&&n.dialogType=="saveas",this.open_disabled=!!e.open_disabled&&n.dialogType=="open",this.disabled=!!e.disabled||this.open_disabled||this.save_disabled,this.raw=e,this.path=e.link_path,this.filename=e.filename,this.display_name=e.display_name,this.count=e.count||null,this.mimetype=e.mimetype,this.is_dir=!!e.is_dir,this.metadata=e.metadata||{},this.size=e.size||this.metadata.size,this.modified=e.modified||this.metadata.modified,this.thumb_exists=!!e.thumb_exists,this.thumbnail=e.thumbnail,r[this.path]=this,this):new o(e)};return o.prototype.fetchMetadata=function(){this.loadingMetadata=!0;var n=this,r=t.urls.get+this.path,i=this;t.getJSON(r,{format:"info"},function(t){for(var r in t)i.metadata[r]=t[r];i.size=e.toNumber(i.metadata.size||i.size,0),i.modified=i.metadata.modified||i.modified,n.loadingMetadata=!1,i.fireLoadCallbacks()},function(e){n.loadingMetadata=!1,i.fireLoadCallbacks()},t.priority.LOW)},o.prototype.getMetadata=function(){return this.metadata||{}},o.prototype.addOnLoad=function(e){this.onLoadCallbacks||(this.onLoadCallbacks=[]),this.loadingMetadata?this.onLoadCallbacks.push(e):e()},o.prototype.fireLoadCallbacks=function(){var e=this.onLoadCallbacks||[];while(e.length>0){var t=e.shift();t&&typeof t=="function"&&t()}},{PathObject:o,fetch:i,wipe:s}}),define("folder",["lodash","./server","./pathobject"],function(e,t,n){var r={},i=function(e,t){return(t?r[e+"?search="+t]:r[e])||undefined},s=function(e,t,n){n?r[t+"?search="+n]=e:r[t]=e},o=function(e,t){delete r[e]},u=function(e,t){var n=i(e,t);return n||(n=a(e,undefined,t),n.reload()),n},a=function(e,t,n){t=t||"Loading";var r=new f(e,{search:n,filename:t,contents:[],auth:!0});return r.loading=!0,r},f=function(e,t){return this instanceof f?(this.path=e,this.search=t.search,s(this,this.path,this.search),this.update(t),this):new f(e,t)};return f.prototype.update=function(e){this.name=e.filename,this.client=e.client,this.view=e.view,this.allow_save=e.allow_save!==!1,this.auth=e.auth===undefined?!0:e.auth,this.loginFields=e.loginFields||null,this.next=e.next||null,this.loading=!1,this.options=e.options,this.precache=e.precache===undefined?!0:e.precache,this.setContents(e.contents)},f.prototype.loadMore=function(e,n){e=e||function(){},n=n||function(){};if(!this.next){e();return}var r=t.urls.fetchContents+this.path,i={start:this.next,format:"info"},s=this;t.getJSON(r,i,function(t){s.extend(t),e(t)},function(e){n(e)},t.priority.HIGH)},f.prototype.getContents=function(e){return this.contents},f.prototype.setContents=function(t){if(t==undefined)return;this.contents=e.map(t,function(e){return new n.PathObject(e)})},f.prototype.addContents=function(t){this.contents=this.contents.concat(e.map(t,function(e){return new n.PathObject(e)}))},f.prototype.getChildByName=function(t){return t=t.toLowerCase(),e.find(this.contents,function(e){return e.filename.toLowerCase()===t})},f.prototype.extend=function(e){this.addContents(e.contents),this.next=e.next||null},f.prototype.loadChildFolders=function(){if(this.loading){var t=this;this.addOnLoad(function(){t.loadChildFolders()})}else e.chain(this.contents).where({is_dir:!0}).pluck("path").map(u)},f.prototype.addOnLoad=function(e){this.onLoadCallbacks||(this.onLoadCallbacks=[]),this.loading?this.onLoadCallbacks.push(e):e()},f.prototype.fireLoadCallbacks=function(){var e=this.onLoadCallbacks||[];while(e.length>0){var t=e.shift();t&&typeof t=="function"&&t()}},f.prototype.reload=function(){var e={format:"info"};this.search&&(e.search=this.search);var n=t.urls.fetchContents+this.path;this.loading=!0;var r=this;t.getJSON(n,e,function(e){r.update(e),r.loading=!1,r.fireLoadCallbacks()},function(e){r.error=e,r.loading=!1,r.fireLoadCallbacks()},t.priority.MEDIUM)},f.prototype.unauth=function(){this.auth=!1,t.getJSON(t.urls.clientUrl+this.client+"/unauth/",{},function(e){},function(e){},t.priority.HIGH)},f.prototype.getBreadcrumbs=function(){var e=[{path:"/",filename:"Filepicker"}],t=this.path.split("/"),n="/",r,s;for(var o=0;o<t.length;o++){var u=t[o];u!==""&&(n+=u+"/",s=i(n),s!==undefined&&!s.loading?r=s.name:r=decodeURIComponent(u),e.push({path:n,filename:r}))}return e},{Folder:f,fetch:i,load:u,wipe:o}}),define("previewpane",["jquery","./templates","./view"],function(e,t,n){var r={selector:"#preview"},i={OFF:0,ON:1,DIM:2},s=function(){return this instanceof s?(this.disabled=!1,this.display=i.OFF,this.selection=undefined,this.view=undefined,this):new s};return s.prototype.hide=function(){this.display=i.OFF},s.prototype.show=function(){this.display=i.ON},s.prototype.dim=function(){this.display=i.DIM},s.prototype.disable=function(){this.disabled=!0},s.prototype.enable=function(){this.disabled=!1},s.prototype.getDisplay=function(){return this.display},s.prototype.setSelection=function(e){this.selection=e},s.prototype.clearSelection=function(){this.selection=undefined},s.prototype.getSelection=function(){return this.selection},s.prototype.update=function(){var t=this.render(),i=e(r.selector);i.length===0?n.append(t):i.replaceWith(t)},s.prototype.render=function(){return this.disabled||this.display==i.OFF?'<div id="'+r.selector.substring(1)+'"></div>':(this.view=this.renderView(),this.display==i.DIM&&this.view.addClass("opacity20"),this.view)},s.prototype.renderView=function(){if(!this.selection)return e(t.render("preview_helptext",{message:"Select file to upload"}));var n=e(t.render("preview",{selection:this.selection}));return this.selection.thumb_exists&&n.find(".thumbnail-image").load(function(){var t=e(this);t.prev(".thumbnail-spinner").hide(),t.show()}).hide(),n},s.prototype.refresh=function(){var e=this.view;e&&e.replaceWith(this.render())},{PreviewPane:s}}),define("folderview",["./templates","./notify","./view","./folder","./pathobject","./previewpane","jquery","./server","./comm","./navigation","./servervars","json"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h={loadNext:"#load-next",uploadButton:".btn-upload",loginForm:"#login-form",extrauploadbutton:"#extra-upload-button"},p=function(){return this instanceof p?(this.useAuthStaging=!0,this.previewPane=this.createPreviewPane(),this):new p};return p.prototype.createPreviewPane=function(){return new s.PreviewPane},p.prototype.render=function(e){if(e.loading){this.renderLoading(e);var t=this,r=f.current();e.addOnLoad(function(){f.matches(f.current(),r)&&t.render(e)})}else e.auth?e.error?this.renderError(e):e.view=="thumbnails"?this.renderThumbnails(e):e.view=="list"?this.renderList(e):e.view=="emptylist"?this.renderList(e):e.view=="emptythumb"&&this.renderThumbnails(e):e.loginFields?this.renderLogin(e):this.renderOAuth(e);n.setActiveClient(e.client),n.setView(this)},p.prototype.renderLoading=function(e){this.previewPane.dim(),n.overlayContents("Loading","#picker")},p.prototype.renderError=function(e){t.error(e.error)},p.prototype.renderThumbnails=function(t){o(h.extrauploadbutton).css("visibility","visible"),t.precache&&t.loadChildFolders();var r=this.renderBreadcrumbs(t),i={folder:t},s=o(e.render("folder_thumbnails",i));n.setContents(s,r);if(t.contents.length>0){this.previewPane.show();var u=this.previewPane.render();n.append(u)}else this.previewPane.hide();this.applyFolderHandlers(t,s,u)},p.prototype.renderList=function(t){o(h.extrauploadbutton).css("visibility","visible"),t.precache&&t.loadChildFolders(),this.previewPane.show();var r=this.renderBreadcrumbs(t),i={folder:t},s=o(e.render("folder",i)),u=this.previewPane.render();n.setContents(s,r,u),this.applyFolderHandlers(t,s,u)},p.prototype.renderBreadcrumbs=function(t){var n=t.getBreadcrumbs(),r=e.render("breadcrumbs",{path:n});return e.render("breadcrumbs_pane",{breadcrumbs:r})},p.prototype.renderLogin=function(n,i){var s={};s.fields=n.loginFields.form,s.title=this.getAuthTitle(n);var a=o(e.render("login",s)),l=this;a.find(h.loginForm).submit(function(e){var s=c.stringify(o(this).serializeArray());return u.loginClient(n.client,s,function(e){!e.redirect||(window.location.hash=e.redirect),r.wipe(n.path),f.refresh()},function(e){t.error(e),l.renderLogin(n,i)}),l.renderLoading(),!1}),this.setView(a)},p.prototype.renderOAuth=function(t){var n={};n.useStaging=this.useAuthStaging,n.newWindow=l.iframe,n.name=t.name,n.client=t.client,n.params=window.location.search,n.title=this.getAuthTitle(t),n.dialogType=this.getDialogType(),this.setView(e.render("auth",n))},p.prototype.getAuthTitle=function(e){return"Upload a file from "+e.name},p.prototype.getDialogType=function(){return"open"},p.prototype.setView=function(e){n.setContents(e)},p.prototype.applyFolderHandlers=function(e,t,n){this.applySortHandler(t),this.applyLoadNextHandler(e,t),this.applyDisabledFolderHandler(t),this.applyClickHandler(t),n&&this.applyUploadHandler(n)},p.prototype.applySortHandler=function(e){var t=this;e.find(".picker_files_header").bind("click",function(){var n=o(this);n.hasClass("top")?(n.removeClass("top").addClass("bottom"),n.find("li i").addClass("icon-arrow-down").removeClass("icon-arrow-up").removeClass("icon-resize-vertical"),t.sortFileList(e.find("#picker_files"),!1)):(n.removeClass("bottom").addClass("top"),n.find("li i").addClass("icon-arrow-up").removeClass("icon-arrow-down").removeClass("icon-resize-vertical"),t.sortFileList(e.find("#picker_files"),!0))})},p.prototype.sortFileList=function(e,t){var n=e.find("LI"),r=function(e,t){return e.children("a").attr("name").toLowerCase().localeCompare(t.children("a").attr("name").toLowerCase())};if(t){var i=r;r=function(e,t){return-1*i(e,t)}}var s=n.length,o,u,a,f,l=function(e,t,n){var r=e[t];e[t]=e[n],e[n]=r};for(o=1;o<n.length;o++){a=n.eq(o),u=o-1;while(u>0&&r(a,n.eq(u))<0)u--;u===0&&r(a,n.eq(0))<0?(a.insertBefore(n.eq(0)),l(n,o,0)):u!=o-1&&(a.insertAfter(n.eq(u)),l(n,o,u+1))}},p.prototype.applyLoadNextHandler=function(e,t){var n=this;t.find(h.loadNext).bind("click",function(t){return o(this).text("Loading"),o("body").addClass("loading"),e.loadMore(function(){o("body").removeClass("loading");var t=o(".selectedItem").map(function(e,t){return o(t).attr("path")});n.render(e),t.each(function(e,t){o('a[path="'+t+'"]').addClass("selectedItem")});if(n.lastSelected){var r=n.lastSelected.children().attr("path");console.log(r),n.lastSelected=o('a[path="'+r+'"]').parent()||n.lastSelected}}),t.stopPropagation(),t.preventDefault(),!1})},p.prototype.applyDisabledFolderHandler=function(e){e.find(".directory").each(function(e,t){t=o(t),!t.data("disabled")||(t.addClass("disabled"),typeof t.data("disabled")=="string"&&t.attr("title",t.data("disabled")),t.click(function(e){return e.stopPropagation(),e.preventDefault(),!1}))})},p.prototype.applyClickHandler=function(e){var t=this;e.find(".selectable").each(function(e,n){n=o(n),n.data("disabled")?(n.addClass("disabled"),typeof n.data("disabled")=="string"&&n.attr("title",n.data("disabled"))):(n.click(t.getOnClickHandler()),n.dblclick(t.getOnDblClickHandler()))})},p.prototype.getOnClickHandler=function(){var e=this;return function(t){var n=o(this),r=n.hasClass("selectedItem");n.parent().siblings().children().removeClass("selectedItem"),r?n.removeClass("selectedItem"):n.addClass("selectedItem"),n.addClass("selectedItemActive"),n.mouseleave(function(){o(this).removeClass("selectedItemActive"),o(this).unbind("mouseleave")});if(r)e.previewPane.clearSelection();else{var s=n.attr("path"),u=i.fetch(s);u&&u.fetchMetadata(),e.previewPane.setSelection(u)}return e.previewPane.update(),e.applyUploadHandler(e.previewPane.view),t.stopPropagation(),t.preventDefault(),!1}},p.prototype.getOnDblClickHandler=function(){var e=this;return function(t){var n=o(this),r=n.attr("path"),s=i.fetch(r);return u.isUploading()||!s?!1:(e.uploadObject(s),!0)}},p.prototype.uploadObject=function(e){var r=o(h.uploadButton);r.addClass("disabled").text("Uploading");var i=n.addUploadingBanner();u.uploadPathObject(e,function(e){r.removeClass("disabled").text("Uploaded!"),i.html("Uploaded").removeClass("spinner").addClass("done"),a.sendResponse(e.url,e.data)},function(e){t.error(e),i.remove(),r.removeClass("disabled").text("Upload")})},p.prototype.applyUploadHandler=function(e){var t=this,n=function(){var e=t.previewPane.selection,n=o(h.uploadButton);return u.isUploading()||n.hasClass("disabled")||!e?!1:(t.uploadObject(e),!0)};o(h.uploadButton).off("click.upload").on("click.upload",n)},{FolderView:p}}),define("exportform",["./templates","./notify","./comm","./view","./util","./server","jquery"],function(e,t,n,r,i,s,o){var u={form:"#saveasForm",file:"#saveas-filename",submit:"#saveas-submit"},a=function(e,t){return this instanceof a?(this.filename=e,this.extension=t,this):new a(e,t)};return a.prototype.initialize=function(t){var n=t.getBreadcrumbs(),r=e.render("breadcrumbs",{path:n}),i={extension:this.extension,breadcrumbs:r};this.pane=o(e.render("save",i)),this.filename&&(this.pane.find(u.file).val(this.filename),this.pane.find(u.submit).removeClass("disabled"))},a.prototype.update=function(e){this.folder=e,this.validate()},a.prototype.validate=function(){var e=this.pane.find(u.submit),t=this.pane.find(u.file);if(t.length&&t.val()){e.text("Save As").addClass("btn-primary").removeClass("btn-warning"),e.toggleClass("disabled",!this.folder.allow_save);var n=t.val()+(this.extension||""),r=this.folder.getChildByName(n);r&&(r.is_dir?e.text("Can't Overwrite Folder").addClass("disabled"):e.text("Overwrite").addClass("btn-warning").removeClass("btn-primary"))}else e.addClass("disabled")},a.prototype.applyClickHandlers=function(){var e=this;this.pane.find(u.file).keyup(function(t){if(t.which==13)return;e.validate()});var n=function(n){var r=e.pane.find(u.file).val();if(r.indexOf("/")>=0)return t.error("This folder doesn't allow you to save files with '/' in the filename, please choose a different name and try again"),n.stopPropagation(),n.preventDefault(),!1;var i=e.pane.find(u.submit);return i.hasClass("disabled")?(n.stopPropagation(),n.preventDefault(),!1):(e.exportFile(),n.stopPropagation(),n.preventDefault(),i.html("Saving").addClass("disabled"),!1)};this.pane.find(u.submit).click(n),this.pane.find(u.form).submit(n)},a.prototype.exportFile=function(){var e=this.pane.find(u.file).val()+(this.extension||""),o=!!this.folder.getChildByName(e),a=r.addUploadingBanner().html("Saving");e=encodeURIComponent(e);var f=i.joinPath(this.folder.path,e);s.saveFile(f,o,function(e){var t=e.url;delete e.url,n.sendResponse(t,e),a.html("Saved").removeClass("spinner").addClass("done")},function(e){t.error(e),a.hide()})},a.prototype.render=function(e){return(!this.pane||this.folder!=e)&&this.initialize(e),this.update(e),this.pane},a.prototype.clear=function(){this.pane.find(u.file).val("")},a.prototype.setFilename=function(e){if(this.extension){var t=e.search("\\"+this.extension+"$");t!=-1&&(e=e.slice(0,t))}this.pane.find(u.file).val(e),this.validate()},{ExportForm:a}}),define("exportpreviewpane",[],function(){var e=function(){};return{selection:undefined,view:"",display:0,hide:e,show:e,dim:e,setSelection:e,clearSelection:e,getSelection:e,update:e,render:e,renderView:e,refresh:e}}),define("exportfolderview",["./templates","./folderview","./exportform","./exportpreviewpane","./pathobject"],function(e,t,n,r,i){var s=function(e,r){return this instanceof s?(t.FolderView.call(this),this.form=new n.ExportForm(e,r),this):new s(e,r)};return s.prototype=new t.FolderView,s.prototype.getAuthTitle=function(e){return this.form.filename?"Save '"+this.form.filename+"' to "+e.name:"Save this file to "+e.name},s.prototype.getDialogType=function(){return"saveas"},s.prototype.renderBreadcrumbs=function(e){return this.form.render(e)},s.prototype.createPreviewPane=function(){return r},s.prototype.applyFolderHandlers=function(e,n,r){t.FolderView.prototype.applyFolderHandlers.call(this,e,n,r),this.form.applyClickHandlers()},s.prototype.getOnClickHandler=function(){var e=this;return function(t){var n=$(this).attr("path"),r=i.fetch(n)||{};return e.form.setFilename(r.filename),t.stopPropagation(),t.preventDefault(),!1}},s.prototype.getOnDblClickHandler=function(){return function(){}},{ExportFolderView:s}}),define("multipreviewpane",["jquery","./previewpane","./templates","./servervars"],function(e,t,n,r){var i=function(){return this instanceof i?(t.PreviewPane.call(this),this):new i};return i.prototype=new t.PreviewPane,i.prototype.renderView=function(){if(!this.selection||this.selection.length===0)return r.maxFiles?e(n.render("preview_helptext",{message:"Select up to "+r.maxFiles+" files",subMessage:"Click to select multiple items."})):e(n.render("preview_helptext",{message:"Select files",subMessage:"Click to select multiple items."}));var t={};t.disabled=!this.selection.length,this.selection.length==1?t.title="1 selected file":t.title=this.selection.length+" selected files",r.maxFiles&&this.selection.length>r.maxFiles&&(t.title="Only select "+r.maxFiles+" files maximum.",t.disabled=!0),t.thumbs=this.selection.length<=5,this.selection.length<7?t.items=this.selection:(t.items=this.selection.slice(0,6),t.andMore=this.selection.length-6);var i=e(n.render("preview_multi",t));return i.find(".thumbnail-image").load(function(){var t=e(this);t.prev(".thumbnail-spinner").hide(),t.show()}).hide(),i},{MultiPreviewPane:i}}),define("multifolderview",["./templates","./folderview","./multipreviewpane","./pathobject","./server","./view","./comm","./notify","./servervars","jquery","lodash"],function(e,t,n,r,i,s,o,u,a,f,l){var c={loadNext:"#load-next",uploadButton:".btn-upload",picker:"#picker"},h=function(){return this instanceof h?(t.FolderView.call(this),this.lastSelected=null,this):new h};h.prototype=new t.FolderView,h.prototype.createPreviewPane=function(){return new n.MultiPreviewPane},h.prototype.getAuthTitle=function(e){return"Upload files from "+e.name},h.prototype.getOnClickHandler=function(){var e=this;return function(t){var n=f(this);n.toggleClass("selectedItem"),n.addClass("selectedItemActive"),n.mouseleave(function(){f(this).removeClass("selectedItemActive"),f(this).unbind("mouseleave")});if(t.shiftKey&&e.lastSelected){var i=n.parent().parent().children(),s=i.index(n.parent()),o=i.index(e.lastSelected);o>=0?(s>o?i=i.slice(o,s):i=i.slice(s,o),i.children(".selectable:not('.disabled')").addClass("selectedItem")):e.lastSelected=n.parent()}else e.lastSelected=n.parent();var u=[],l=f(".selectedItem").each(function(e,t){var n=f(t).attr("path"),i=r.fetch(n)||{};i&&i.fetchMetadata(),u.push(i)});return e.previewPane.setSelection(u),a.mobile&&(u.length>0?e.previewPane.show():e.previewPane.hide(),l.addClass("checked")),e.previewPane.update(),e.applyUploadHandler(e.previewPane.view),t.stopPropagation(),t.preventDefault(),!1}},h.prototype.applyUploadHandler=function(e){var t=this,n=function(){var e=t.previewPane.selection,n=f(c.uploadButton);if(i.isUploading()||n.hasClass("disabled")||!e)return!1;var r=e.length,a=!1,h=s.addUploadingBanner(),p=function(){a?(n.removeClass("disabled").text("Try Again"),h.hide()):r===0&&o.sendAllResponses(d)},d=[];return l.forEach(e,function(t){i.uploadPathObject(t,function(t){r--,d.push(t);var n=e.length-r;h.text("Uploaded "+n+" of "+e.length+" files"),p()},function(e){r--,a||(a=!0,u.error(e)),p()},i.priority.LOW)}),!0};f(c.uploadButton).off("click.upload").on("click.upload",n)};var p=function(e){var t=["createPreviewPane","getOnClickHandler","applyUploadHandler"];for(var n=0;n<t.length;n++)e[t[n]]=h.prototype[t[n]];return e.previewPane=e.createPreviewPane(),e};return{MultiFolderView:h,wrap:p}}),define("selectfolderview",["./templates","./folderview","./pathobject"],function(e,t,n){var r=function(){return this instanceof r?(t.FolderView.call(this),this):new r};return r.prototype=new t.FolderView,r.prototype.getAuthTitle=function(e){return"Select a folder from "+e.name},r.prototype.getDialogType=function(){return"folder"},r.prototype.applyFolderHandlers=function(e,n,r){t.FolderView.prototype.applyFolderHandlers.call(this,e,n,r),this.applySubfolderClickHandlers(e,n)},r.prototype.applySubfolderClickHandlers=function(e,t){t.find(".directory").each(function(e,t){t=$(t);var n=t.attr("path"),r=t.children(".open-folder").click(function(){window.location.hash="#"+n})})},{SelectFolderView:r}}),define("client",["./navigation","./folder","./folderview","./exportfolderview","./multifolderview","./selectfolderview","./servervars","./global","./util","./view"],function(e,t,n,r,i,s,o,u,a,f){var l={OPEN:"open",SAVE:"save",BOTH:"both"},c={auth_label:".auth-label",single_service_logout:"#single-service-logout"},h={},p=function(e){return h[e]},d=function(e,t,n,r){return this instanceof d?(this.id=e,this.url=t,this.server_path=n,this.type=r||l.BOTH,h[this.id]=this,this):new d(e,t,n,r)};d.prototype.setPickView=function(e){this.pick_view=e},d.prototype.setPickMultipleView=function(e){this.multi_pick_view=e},d.prototype.setExportView=function(e){this.export_view=e},d.prototype.getPickView=function(){return this.pick_view||(this.pick_view=new n.FolderView),this.pick_view},d.prototype.getMultiPickView=function(){if(!this.multi_pick_view)if(this.pick_view){var e=a.clone(this.pick_view);this.multi_pick_view=i.wrap(e)}else this.multi_pick_view=i.MultiFolderView();return this.multi_pick_view},d.prototype.getExportView=function(){return this.export_view||(this.export_view=new r.ExportFolderView(o.defaultSaveasName,o.extension)),this.export_view},d.prototype.getSelectFolderView=function(){return this.folder_view||(this.folder_view=new s.SelectFolderView),this.folder_view},d.prototype.getView=function(){return o.dialogType=="open"?o.multiple?this.getMultiPickView():this.getPickView():o.dialogType=="saveas"?this.getExportView():o.dialogType=="folder"?this.getSelectFolderView():(a.console.log("Unknown type",o.dialogType),undefined)},d.prototype.render=function(e){e=e||"",e=this.server_path+e;var n,r=e.split("?",2);r.length==2&&(e=r[0],n=r[1].match(/search=([^&]+)/),n&&(n=unescape(n[1])));var i=t.load(e,n),s=this.getView();s.render(i)},d.prototype.initialize=function(){var n=this;if(this.type==l.BOTH||o.dialogType=="open"&&this.type==l.OPEN||o.dialogType=="saveas"&&this.type==l.SAVE){e.register(this.url,function(){n.render(this.params.path)});var r=t.load(this.server_path);return r.addOnLoad(function(){n.setAuthed(r.auth)}),e.matches(e.current(),this.url)&&e.refresh(),!0}return!1},d.prototype.setAuthed=function(n){var r=f.getClientLink(this.id).find(c.auth_label);r=r.add(c.single_service_logout+'[data-client="'+this.id+'"]');if(n){var i=this;r.removeClass("disabled"),r.click(function(){var n=t.load(i.server_path);n.unauth(),e.refresh(),i.setAuthed(!1)})}else r.addClass("disabled")};var v=function(n){t.wipe(n);var r=t.load(n);r.addOnLoad(function(){var e=p(r.client);e&&e.setAuthed(r.auth)}),e.refresh()},m={finishAuth:v};return u.add("nav",m),{Client:d,Type:l}}),define("dropbox",["./client"],function(e){var t={id:"dropbox",url:"#/Dropbox/(:path*)",path:"/Dropbox/"},n=new e.Client(t.id,t.url,t.path);return n}),define("facebook",["./client"],function(e){var t={id:"facebook",url:"#/Facebook/(:path*)",path:"/Facebook/"},n=new e.Client(t.id,t.url,t.path);return n}),define("googledrive",["./client"],function(e){var t={id:"googledrive",url:"#/GoogleDrive/(:path*)",path:"/GoogleDrive/"},n=new e.Client(t.id,t.url,t.path);return n}),define("box",["./client"],function(e){var t={id:"box",url:"#/Box/(:path*)",path:"/Box/"},n=new e.Client(t.id,t.url,t.path);return n}),define("picasa",["./client"],function(e){var t={id:"picasa",url:"#/Picasa/(:path*)",path:"/Picasa/"},n=new e.Client(t.id,t.url,t.path);return n}),define("instagram",["./client"],function(e){var t={id:"instagram",url:"#/Instagram/(:path*)",path:"/Instagram/"},n=new e.Client(t.id,t.url,t.path,e.Type.OPEN);return n}),define("flickr",["./client"],function(e){var t={id:"flickr",url:"#/Flickr/(:path*)",path:"/Flickr/"},n=new e.Client(t.id,t.url,t.path);return n}),define("link",["./servervars","./navigation","./templates","./view","./server","./comm","./prettyprint","./mimetypes","lodash"],function(e,t,n,r,i,s,o,u,a){var f={};f.url="#/url/",f.input="#urlInput",f.form="#urlForm",f.button=".btn-upload";var l=function(){if(e.dialogType=="saveas")return;t.register(f.url,p)},c,h,p=function(){if(e.dialogType=="saveas")return;r.setContents(n.render("url")),r.setActiveClient("url"),r.setView({unload:function(){window.clearInterval(h)}}),$(f.form).submit(function(){return E(),!1}),c=$(n.render("preview_url",{disabled:!0})),d&&v(d),m&&$(f.input).val(m),r.append(c),r.get().on("click",f.button,function(){var e=$(this);e.hasClass("disabled")||E()}),$(f.input).keyup(function(){g()}),h=window.setInterval(function(){g()},500)},d,v=function(e){d=e;var t=$(n.render("preview_url",e));return c.replaceWith(t),c=t,c.find(".thumbnail-image").load(function(){var e=$(this);e.prev(f.spinner).hide(),e.fadeIn()}).hide(),c},m,g=function(e){var t=$(f.input).val();if(!e&&t==m)return;m=t;var n;t?(v({loading:!0,disabled:!0}),w()):v({disabled:!0})},y=function(t){return u.match(t.type,e.mimetypes)?e.maxSize&&t.size>e.maxSize?(v({error:"File too large. Must be less than "+o.print_size(e.maxSize),disabled:!0}),!1):!0:(v({error:"Not the right type of file. Must be "+e.mimetypes,disabled:!0}),!1)},b,w=function(){var e=$(f.input).val(),t={url:e,format:"info"},n;i.getJSON(i.urls.getUrlInfo,t,function(e){var t={thumb_exists:e.thumb_exists,thumbnail:e.thumbnail,filename:e.filename,size:e.size,display_size:o.print_size(e.size),type:e.type,display_type:o.print_mimetype(e.type),metadata:e.metadata};y(t)&&v(t)},function(e){b=undefined,v({error:e,disabled:!0})},i.priority.MEDIUM)},E=function(){$(f.button).html("Uploading").addClass("disabled"),$(f.input).attr("disabled","disabled");var e=$(f.input).val();if(!e)return;var t=r.addUploadingBanner(),n=(b||{}).filename||"tmp";i.setUploading(!0),i.uploadUrl(e,n,function(e){$(f.input).removeAttr("disabled"),$(f.button).removeClass("disabled").text("Uploaded!");if(b&&b.metadata)for(var n in b.metadata)e[n]=e[n]||b.metadata[n];var r=e,o=e.url;delete e.url,t.html("Uploaded").removeClass("spinner").addClass("done"),i.setUploading(!1),s.sendResponse(o,r)},function(e){$(f.input).removeAttr("disabled"),$(f.button).removeClass("disabled").text("Uploaded!"),t.hide(),v({error:e,disabled:!1}),$(f.button).text("Try again"),i.setUploading(!1)})},S=function(e){b=e},x=function(){return b};return{initialize:l,render:p,update:g,setCurrentFile:S}}),define("github",["./client"],function(e){var t={id:"github",url:"#/Github/(:path*)",path:"/Github/"},n=new e.Client(t.id,t.url,t.path,e.Type.OPEN);return n}),define("alfresco",["./client"],function(e){var t={id:"alfresco",url:"#/Alfresco/(:path*)",path:"/Alfresco/"},n=new e.Client(t.id,t.url,t.path);return n}),define("gmailfolderview",["./templates","./folderview","./view"],function(e,t,n){var r=function(){return this instanceof r?(t.FolderView.call(this),this):new r};return r.prototype=new t.FolderView,r.prototype.renderList=function(t){t.precache&&t.loadChildFolders(),this.previewPane.show();var r=this.renderBreadcrumbs(t),i={folder:t},s=$(e.render("gmailfolder",i)),o=this.previewPane.render();n.setContents(s,r,o),this.applyFolderHandlers(t,s,o)},{GmailFolderView:r}}),define("gmail",["./client","./gmailfolderview"],function(e,t){var n={id:"gmail",url:"#/Gmail/(:path*)",path:"/Gmail/"},r=new t.GmailFolderView,i=new e.Client(n.id,n.url,n.path,e.Type.OPEN);return i.setPickView(r),i}),define("webcamclient",["require","./navigation","./servervars","./server","./templates","./view","./notify","./comm","jquery"],function(e,t,n,r,i,s,o,u,a){var f={id:"webcam",url:"#/webcam/",filesize:28208,quality:"90",width:480,height:360,swf_url:"/static/res/webcam/webcam.swf"},l=function(){if(n.dialogType=="saveas")return;t.register(f.url,c)},c=function(){s.setContents(i.render("webcam")),s.setActiveClient(f.id),s.setView(this);if(n.maxSize&&n.maxSize<f.filesize){var t="The site has asked only for files smaller than "+PrettyPrint.print_size(n.maxSize)+", and a webcam image would be too large",o=a("<p></p>").addClass("alert").text(t);a("#picker").append(o);return}e(["webcam"],function(e){var t=r.urls.uploadWebcam+"?js_session="+r.getJsSession(!0)+"&mimetype=image/jpeg&filename=snap.jpg";e.set_api_url(t),e.set_quality(f.quality),e.set_hook("onComplete",h),e.set_hook("onAllow",p),e.set_swf_url(f.swf_url),e.set_shutter_sound(!1),e.set_hook("onError",d),a("#picker").append(a(e.get_html(f.width,f.height)).addClass("thumbnail center"))})},h=function(e){var t=e;t instanceof Object||(t=JSON.parse(e)),t=r.massageResponse(t);if(t.error)o.error(t.error);else{var n=t.payload[0];n.data.size=f.filesize,n.data.width=f.width,n.data.height=f.height,u.sendResponse(n.url,n.data)}},p=function(e){if(e){var t=a('<a class="btn btn-primary btn-large" style="margin-top: 10px">Snap It</a>');t.click(function(){webcam.snap()}),a("#picker").append(a("<p></p>").append(t))}else t=a('<a class="btn btn-large" style="margin-top: 10px">If you didn\'t mean to, try again?</a>'),t.click(function(){c()}),s.setContents(i.render("webcam")),a("#picker").append(a("<p></p>").addClass("alert").html("The webcam won't work if you deny it access.").append(t))},d=function(){s.clear(),o.error("We're sorry but your webcam is not supported")};return{initialize:l,render:c}}),define("video",["require","./navigation","./servervars","./server","./templates","./view","./notify","./folder","./comm","jquery"],function(e,t,n,r,i,s,o,u,a,f){var l={id:"video",url:"#/video/",path:"/video/",width:360,height:301,swf_url:"/static/res/webcam/webcam.swf",pane:"opentok-pane",status:"#opentok-status"},c=function(){if(n.dialogType=="saveas")return;t.register(l.url,h)},h=function(){s.setContents(i.render("opentok")),s.setActiveClient(l.id),s.setView(this);var t=u.fetch(l.path);t||(t=u.load(l.path));if(t.loading){t.addOnLoad(function(){h()});return}e(["opentok"],function(e){var n=e.initRecorderManager(t.options.key),i=n.displayRecorder(t.options.token,l.pane,{width:l.width,height:l.height}),u;i.addEventListener("archiveSaved",function(e){r.setUploading(!0);var n=s.addUploadingBanner().text("Uploading video");u=e.archives[0].archiveId;var i=l.path+u+"/recording.flv",f={format:"fpurl",token:t.options.token};r.getJSON(r.urls.get+i,f,function(e){n.html("Uploaded").removeClass("spinner").addClass("done");var t=e.url;delete e.url,a.sendResponse(t,e),r.setUploading(!1)},function(e){r.setUploading(!1),n.hide(),o.error(e)},r.priority.MEDIUM)})})},p=function(e){var t=e;t instanceof Object||(t=JSON.parse(e)),t=r.massageResponse(t);if(t.error)o.error(t.error);else{var n=t.payload;n.data.size=l.webcam.filesize,n.data.width=l.webcam.width,n.data.height=l.webcam.height,util.sendResponse(n.url,n.data)}},d=function(e){if(e){var t=f('<a class="btn btn-primary btn-large" style="margin-top: 10px">Snap It</a>');t.click(function(){webcam.snap()}),f("#picker").append(f("<p></p>").addClass("alert").append(t))}else t=f('<a class="btn btn-large" style="margin-top: 10px">If you didn\'t mean to, try again?</a>'),t.click(function(){webcam.snap()}),s.setContents(i.render("webcam")),f("#picker").append(f("<p></p>").addClass("alert").html("The webcam won't work if you deny it access.").append(t))},v=function(){s.clear(),o.error("We're sorry but your webcam is not supported")};return{initialize:c,render:h}}),define("searchfolderview",["./templates","./folderview","./view"],function(e,t,n){var r={button:"#search-submit",input:"#search-query",form:"#search-form"},i=function(){return this instanceof i?(t.FolderView.call(this),this):new i};return i.prototype=new t.FolderView,i.prototype.renderLoading=function(t){var n=$("#picker");if(n.length===0)this.constructor.prototype.renderLoading.call(this,t);else{this.previewPane.dim();var r;t.search?r='Searching for "'+t.search+'"':t.client?r="Searching "+t.client+"":r="Searching",n.html(e.render("loading",{text:r})),this.previewPane.refresh()}},i.prototype.renderBreadcrumbs=function(t){var n={search:t.search},i=$(e.render("searchpane",n)),s=this,o=function(e){s.previewPane.clearSelection();var n=$(r.input).val();return s.search(t,n),e.stopPropagation(),e.preventDefault(),!1};return i.find(r.form).submit(o),i.find(r.button).click(o),i},i.prototype.search=function(e,t){e.search=t,window.location.hash=e.path+"?search="+escape(t)},{SearchFolderView:i}}),define("webimages",["./client","./searchfolderview"],function(e,t){var n={id:"imagesearch",url:"#/Imagesearch/(:path*)",path:"/Imagesearch/"},r=new t.SearchFolderView,i=new e.Client(n.id,n.url,n.path,e.Type.OPEN);return r.renderThumbnails=function(e){this.constructor.prototype.renderThumbnails.call(this,e);if(!e.search&&e.path==n.path){$(".filelist>h3").remove();var t=$("<h3>Search the web for images.<br /><small>Images from Wikipedia, Flickr, and Google Image Search</small></h3>").css("margin-top","5em").css("text-align","center").addClass("emptymessage");$("#picker").append(t)}},r.search=function(e,t){e.search=t,window.location.hash="/Imagesearch/"+encodeURIComponent(t)},r.renderLoading=function(e){if(!e.search){var n=e.path.split("/",3);n.length>2&&(e.search=decodeURI(n[2]))}t.SearchFolderView.prototype.renderLoading.call(this,e)},i.setPickView(r),i.setAuthed=function(){},i}),define("evernote",["./client","./searchfolderview","./exportfolderview","./servervars"],function(e,t,n,r){var i={id:"evernote",url:"#/Evernote/(:path*)",path:"/Evernote/"},s=new e.Client(i.id,i.url,i.path,e.Type.BOTH),o=new t.SearchFolderView;s.setPickView(o);var u=new n.ExportFolderView(r.defaultSaveasName,"");return u.form.validate=function(){var e=this.pane.find("#saveas-submit"),t=this.pane.find("#saveas-filename");e.text("Create Note").addClass("btn-primary"),t.length&&t.val()?e.toggleClass("disabled",!this.folder.allow_save):e.addClass("disabled")},s.setExportView(u),s}),define("ftp",["./client"],function(e){var t={id:"ftp",url:"#/ftp/(:path*)",path:"/ftp/"},n=new e.Client(t.id,t.url,t.path,e.Type.BOTH);return n}),define("webdav",["./client"],function(e){var t={id:"webdav",url:"#/webdav/(:path*)",path:"/webdav/"},n=new e.Client(t.id,t.url,t.path,e.Type.BOTH);return n}),define("sendemail",["./navigation","./servervars","./templates","./view","./server","./comm","./notify","jquery"],function(e,t,n,r,i,s,o,u){var a={id:"email",url:"#/email/",form:"#emailform",fromname:"#email-from",to:"#email-to",message:"#email-message",filename:"#email-filename",submit:"#email-submit",savebar:"#savebar"},f,l=function(){t.dialogType=="saveas"&&e.register(a.url,c)},c=function(){var e=u(n.render("send_email",{extension:t.extension}));t.mobile&&u(a.savebar).hide(),r.setActiveClient(a.id),e.find(a.form).submit(function(){var e={},n=u(a.to),f=n.val();if(!f||f.indexOf("@")==-1)return n.parents(".control-group").addClass("error"),n.after('<span class="help-inline">Invalid email</span>'),!1;var l=u(a.fromname).val(),c=u(a.message).val(),h={filename:u(a.filename).val(),url:t.saveasUrl};u(a.submit).attr("disabled","disabled");var p=r.addUploadingBanner().html("Sending");return i.sendEmail(l,f,c,h,function(e){u(a.submit).removeAttr("disabled"),p.html("Email sent!").removeClass("spinner").addClass("done"),s.sendResponse(t.saveasUrl,{})},function(e){o.error(e)}),!1}),r.setContents(e)};return{initialize:l,render:c}}),define("skydrive",["./client"],function(e){var t={id:"skydrive",url:"#/SkyDrive/(:path*)",path:"/SkyDrive/"},n=new e.Client(t.id,t.url,t.path);return n}),define("clientloader",["require","./computer","./dropbox","./facebook","./googledrive","./box","./picasa","./instagram","./flickr","./link","./github","./alfresco","./gmail","./webcamclient","./video","./webimages","./evernote","./ftp","./webdav","./sendemail","./skydrive"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){var E=function(){t.initialize(),r.initialize(),n.initialize(),i.initialize(),o.initialize(),s.initialize(),w.initialize(),u.initialize(),a.initialize(),f.initialize(),l.initialize(),c.initialize(),h.initialize(),p.initialize(),d.initialize(),v.initialize(),m.initialize(),g.initialize(),y.initialize(),b.initialize()};return{autoload:E}}),define("analytics",["./server"],function(e){var t=function(t,n){n===undefined&&(n=1),e.incrementStat(t,n)};return{increment:t}}),requirejs.config({enforceDefine:!0,paths:{jquery:["//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min","../ext/jquery.min"],lodash:["../ext/lodash.min","//cdnjs.cloudflare.com/ajax/libs/lodash.js/0.9.0/lodash.min"],swfupload:"../../res/swfupload/swfupload.min",webcam:"../../res/webcam/webcam.min",opentok:["https://swww.tokbox.com/v1.1/js/TB.min","../ext/TB.min"],flashdetect:"../ext/flash_detect",json:"../ext/json2"},waitSeconds:30,shim:{jquery:{exports:"jQuery"},handlebars:{exports:"Handlebars"},webcam:{exports:"webcam"},opentok:{exports:"TB"},swfupload:{exports:"SWFUpload"},json:{exports:"JSON"}}}),define("main",["jquery","./navigation","./welcome","./clientloader","./servervars","./analytics","./window"],function(e,t,n,r,i,s,o){n.initialize(),o.initialize(),r.autoload(),i.recent_path!==""&&(!window.location.hash||window.location.hash=="#")&&(window.location.hash=server_vars.recent_path),t.finalize(),window.setTimeout(function(){s.increment("dialog.open")},1e3),e(".delayedload").each(function(){var t=e(this),n=t.data("delay"),r=t.data("src");window.setTimeout(function(){t.attr("src",r)},n)})})