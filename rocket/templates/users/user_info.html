{% extends 'users/users_base.html' %}
{% block title %}Account Info{% endblock %}
{% load static from staticfiles %}
{% load compress %}
	
{% block content %}
	<div class="error-wrapper"></div>
		
		{% if user.get_profile.name %}
			<h3><a class="name-header" href="{% url 'users.views.profile' user.username %}">{{ user.get_profile.name }}</a></h3>
		{% else %}
			<h3><a class="name-header" href="{% url 'users.views.profile' user.username %}">{{user.username}}</a></h3>
		{% endif %}

	<div class="content-wrapper row">
		
		<div class="col-lg-4 screen-lg-right" id="listing-credits">
			<h5>Listing Credits</h5>

			<table class="table">
				<tr>
					<td><p>Credits Left:</p></td>
					<td class="text-center"><p id="credit-counter">{{credits}}</p></td>
					<td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>
				</tr>
				<tr>
					<td><p>Credits Spent:</p></td>
					<td class="text-center"><p>{{credits_spent}}</p></td>
					<td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>
				</tr>
			</table>

			<h6>You can get more listings by</h6>
			<ul>	
				<li><a href="#" id="profile-completed" class="text-left {% if profile_completed_once %}completed{% endif %}">Completing your profile (2 credits)</a></li>

				<li><a href="#" id="twitter-linked" class="text-left {% if twitter_connected_once %}completed{% endif %}">Linking your Twitter account (1 credit)</a></li>

				<li><a href="#" id="facebook-linked" class="text-left {% if facebook_connected_once %}completed{% endif %}">Linking your Facebook account (1 credit)</a></li>

				<li><a href="#" class="text-left">Referring friends (TBD)</a></li>
			</ul>
		</div>


		<form class="settings-form col-lg-8 pull-left" id="user-info-form" action="" method="POST">
			{% if first_visit %}
				<div class="alert alert-info">
  					<button type="button" class="close" data-dismiss="alert">&times;</button>
  					<h4>Info Panel</h4>
  					This is your info panel. Create your profile, connect Twitter and Facebook, and choose your listing defaults.
				</div>
			{% endif %}
			{% csrf_token %}
			<table class="table table-hover">
				<thead>					
						<th>
							<span class="h4 user-info-label">User Info</span>
						</th>
						<th></th>
						<th class="save-all-container">
							<input class="btn btn-primary save-all disabled" type="submit" value="Save all">
						</th>
				</thead>
				<tbody>
					<tr class="uneditable">
						<td>Username</td>
						<td><code class="username">{{ user.username }}</code></td>
						<td></td>
					</tr>
					<tr class="editable">
						<td>Name</td>
						<td class="partial-input">
							<input class="form-control" tabindex="1" name="name" type="text" autocomplete="off" value="{{ user.get_profile.name }}" placeholder="John Doe">
						</td>
						<td><a class="edit active" href="#">Edit</a></td>
					</tr>
					<tr class="editable"> 
						<td>Email</td>
						<td class="partial-input">
							<input class="user-email form-control" tabindex="2" name="email" type="text" autocomplete="off" value="{{ user.email }}" placeholder="johndoe@gmail.com">
						</td>
						<td><a class="edit active" href="#">Edit</a></td>
					</tr>
					
					<tr class="uneditable">
						<td>Profile Picture</td>
						{% if user.get_profile.propic %}
						<td>
							<div class="propic-wrapper">
								<img class="propic" src="{{user.get_profile.propic}}" height="100px" width="100px">
								<span class="loading-overlay hide"><img src="{% static 'users/img/100px_loading.gif' %}"></span>
							</div>
							<input class="propic-url" type="hidden" name="propic" value="{{user.get_profile.propic}}">
						</td>
						{% else %}
						<td>
							<div class="propic-wrapper">
								<img class="propic" src="http://placekitten.com/100/100" height="100px" width="100px">
								<span class="loading-overlay hide"><img src="{% static 'users/img/100px_loading.gif' %}"></span>
							</div>
							<input class="propic-url" type="hidden" name="propic" value="">
						</td>
						{% endif %}
						<td><a class="change-propic active" href="#">Change Picture</a></td>
					</tr>

					<tr class="uneditable">
						<td>Password</td>
						<td>&#149;&#149;&#149;&#149;&#149;&#149;&#149;&#149;</td>
						<td><a class="change-password active" href="/users/password/change/">Change Password</a></td>
					</tr>
					<tr class="editable">
						<td>Phone</td>
						<td class="partial-input">
							<input class="form-control" tabindex="3" name="phone" type="text" autocomplete="off" value="{{ user.get_profile.phone }}" placeholder="(888) 888-8888">
						</td>
						<td><a class="edit active" href="#">Edit</a></td>
					</tr>
					<tr class="editable">
						<td>Location</td>
						<td class="partial-input">
							<input class="form-control" tabindex="4" id="id_location" autocomplete="off" name="location" type="text" value="{{ user.get_profile.location }}" placeholder="Burlington, VT">
						</td>
						<td><a class="edit active" href="#">Edit</a></td>
					</tr>
					<tr class="editable">
						<td>Bio</td>
						<td class="partial-input">
							<textarea class="form-control" tabindex="5" name="bio" autocomplete="off" rows="3" placeholder="Click to write your bio">{{ user.get_profile.bio }}</textarea>
						</td>
						<td><a class="edit active" href="#">Edit</a></td>
					</tr>
					<tr>
						<td class="subheader"><h4>Identity </h4></td>
					</tr>
					<tr class="uneditable">
						<td>Twitter</td>
						<td>
							<span class="at {% if not user.get_profile.twitter_handle %}muted{% endif %}">@</span><span class="twitter-handle">{{ user.get_profile.twitter_handle }}</span>
						</td>
						<td>
							<a class="verify-twitter {% if user.get_profile.twitter_handle %}hide{% endif %}" href="#">Connect</a>
							<a class="disconnect-twitter {% if not user.get_profile.twitter_handle %}hide{% endif %}" href="#">Disconnect</a>
						</td>
					</tr>
					<tr class="uneditable">
						<td>Facebook</td>
						<td>
							<span class="fb-name">{{ fb.name }}</span>
						</td>
						<td>
							<a class="connect-fb {% if fb.name %}hide{% endif %}" href="#">Connect</a>
							<a class="disconnect-fb {% if not fb.name %}hide{% endif %}" href="#">Disconnect</a>	
						</td>
					</tr>
					<tr>
						<td class="subheader"><h4>Listings</h4></td>
					</tr>
					<tr class="editable">
						<td>Default Seller Type</td>
						<td class="select">
							<select class="form-control" id="id_default_seller_type" name="default_seller_type" value="{{user.get_profile.default_seller_type}}">
								{% for value, text in form.default_seller_type.field.choices %}
									<option value="{{value}}" {% ifequal value form.default_seller_type.value %}selected="selected"{%endifequal%}>{{text}}</option>
								{% endfor %}
							</select>
						</td>
						<td></td>
					</tr>
					<tr class="editable">
						<td>Default Listing Type</td>
						<td class="select">
							<select class="form-control" id="id_default_listing_type" name="default_listing_type" value="{{user.get_profile.default_listing_type}}"> 
						    {% for value, text in form.default_listing_type.field.choices %}
						    	<option value="{{value}}" {% ifequal value form.default_listing_type.value %}selected="selected"{%endifequal%}>{{text}}</option>
						    {% endfor %}
							</select>
						</td>
						<td></td>
					</tr>
					<tr class="editable">
						<td>Default Category</td>
						<td class="select">
							<select class="form-control" id="id_default_category" name="default_category" value="{{user.get_profile.default_category.id}}">
								{% for option in form.default_category.field.choices.queryset %}
						       		<option value="{{forloop.counter}}" {% ifequal option user.get_profile.default_category %}selected="selected"{%endifequal%}>{{option}}</option>
								{% endfor %}
							</select>
						</td>
						<td></td>
					</tr>
					
					<tr>
						<td><a class="delete-account-modaltrigger text-danger" role="button" data-toggle="modal" href="#delete-account-modal">Delete account</a></td>
						<td></td><td><input class="btn btn-primary save-all disabled" type="submit" value="Save all"/></td>
					</tr>				
				
				</tbody>		
			</table>
		</form>
		




	</div>

	<div id="delete-account-modal" class="modal">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h3>Delete account</h3>
				</div>
				<div class="modal-body">
					<p>Are you sure you want to delete your account?</p>
				</div>
				<div class="modal-footer">
					<button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
					<a class="delete-account-btn btn btn-danger" href="/users/delete">Delete account</a>
				</div>
			</div>
		</div>
	</div>


{% endblock %}
