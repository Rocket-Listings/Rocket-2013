{% load static from staticfiles %}

{# Requires the context variable 'listings' #}
{% if listings %}
<table class="table table-striped table-bordered table-condensed tablesorter id" id = "table-listings">
	<thead>
		<tr>
			<th class = "sortable">Title <i class="icon-angle-down"></i></th>
			<th class = "sortable">Price<i class="icon-angle-down"></i></th>
			<th class = "sortable">Location<i class="icon-angle-down"></i></th>
			<th class = "sortable">Category<i class="icon-angle-down"></i></th>
			<th class = "sortable">Date Listed<i class="icon-angle-down"></i></th>
			<th class = "centered-th">Highest Offer</th>
			<th class = "centered-th">Messages</th>
			<th class = "centered-th">Copy <br> HTML</th>
			<th class = "centered-th">Edit</th>
			<th class = "centered-th">Delete</th>
			<th>View on Craigslist</th>
			
		</tr>
	</thead>
	<tbody>
		{% for listing in listings %}
		<tr>
			<td><a href="{{ listing.get_absolute_url }}">{{ listing.title }}</a></td>
			<td>${{ listing.price }}</td>
			<td>{{ listing.location }}</td>
			<td>{{ listing.category.name }}</td>
			<td>
				{{ listing.pub_date|date:"m-d-y"}} 
				<br>
				{{ listing.pub_date|date:"P"}}
			</td>
			<td class = "centered-td">
				{% if listing.max_offer %}
				${{listing.max_offer}}
				<br/>
				<a href = "{% url 'listings.views.offers' listing.id %}">View All</a>
				{% else %}
				None
				{% endif %}
			</td>

			<td class = "centered-td">
				<a href = "{% url 'listings.views.messages' listing.id %}" class="stay-color"> 
					<i class="icon-envelope icon-2x"></i>
				</a>
			</td>
			<td>
				<a class="clipboard" data-clipboard-text="{% filter force_escape %}{% include "listing_cl_embed.html" %}{% endfilter %}">
					<i class="icon-download-alt icon-2x"></i>
				</a>
			</td>
			<td><a href="{% url 'listings.views.update' listing.id %}"><i class="icon-edit icon-2x"></i></a></td>
			<td><a href="{% url 'listings.views.delete' listing.id %}"><i class="icon-trash icon-2x"></i></a></td>

			{% if listing.CL_link %}
				<td class = "centered-td">
					<a href = "{{listing.CL_link}}" target="_blank">
						<img src="{% static 'img/cl_icon.png' %}" width = "25" height = "25" class = "grey"></i>
					</a>
				</td> 
			{% else %}
				<td class = "centered-td"> N/A </td>
			{% endif %}
		</tr>
		{% endfor %}
	</tbody>
</table>
{% else %}
<h4>You don't have any listings yet! <a href="#modal-photo-upload" data-toggle="modal">Let's get started making one.</a></h4>
{% endif %}
