{% extends 'listings_base.html' %}

{% block content %}
{% if messages %}
<h4>Messages for your <a href= " {{ listing.get_absolute_url }}">{{ listing.title }}</a></h4>
<div class = "messages-container">
    <div class="sidebar">
		<div class="btn-group-vertical" data-toggle="buttons-radio" name="buyer-tiles" >
			{% for buyer in buyers %}
			<button type="button" class="btn buyer-tiles" id = "buyer-tiles" data-buyerid="{{ buyer.id }}">

						Buyer Name: {{ buyer.name }}<br>
						{% if buyer.max_offer %}
							Highest Offer:
							 ${{buyer.max_offer}}<br>
						{% else %}
							Highest Offer:	None<br>
						{% endif %}
							Last Contacted: {{ buyer.last_message.date|date:"m-d-y P" }}<br>
			</button>
		{% endfor %}
		</div>

	</div>
	{% for buyer in buyers %}
		<div class="content" data-buyerid="{{ buyer.id }}">
			{% for message in messages %}
				{% if buyer.name == message.buyer.name %}
					{% if message.isSeller %}
						  <p class="triangle-border right">{{message.content}}</p>
					{% else %}
						 <p class="triangle-border left">{{message.content}}</p>
					{% endif %}	 
			   	{% endif %}
		   	{% endfor %}
		</div>

		<div class = "bottom" data-buyerid="{{ buyer.id }}">
		<form action = "{% url "listings.views.messages" listing.id %}" method = "POST">
			<div class = "message-box">
				<input type="text" name = 'content' class="input-long" placeholder="  Message..." >
				<input type ="hidden" name = "buyer_id" value = "{{ buyer.id }}" >
			</div>
			<div class = "send">
				<input type="submit" class="btn" id = "send-button" data-buyerid="{{ buyer.id }}">
			</div>
		</form>	
	</div>
	{% endfor %}	
</div>		

{% else %}
<h4>You don't have any messages yet!<h4>
{% endif %}
{% endblock %}